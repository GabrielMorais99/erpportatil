<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
        />
        <meta
            name="description"
            content="Sistema de gest√£o de loja de roupas - Controle de vendas e custos"
        />
        <meta name="theme-color" content="#dc3545" id="theme-color-meta" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta
            name="apple-mobile-web-app-status-bar-style"
            content="black-translucent"
        />
        <meta name="apple-mobile-web-app-title" content="Loja Vendas" />
        <title>Gest√£o Financeira</title>
        <!-- Google Fonts - Dancing Script (cursiva) -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
        <!-- Preload CSS para evitar FOUC -->
        <link rel="preload" href="/css/style.css" as="style" />
        <link rel="stylesheet" href="/css/style.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" onload="window.chartJsLoaded = true;" onerror="console.error('Erro ao carregar Chart.js');"></script>
        <!-- Bibliotecas para exporta√ß√£o avan√ßada -->
        <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.2/dist/jspdf.plugin.autotable.min.js"></script>
        <!-- QR Code Libraries - Usar local no localhost, CDN no Vercel -->
        <script>
            // Fun√ß√£o auxiliar para expor QRCode globalmente
            window.setupQRCode = function() {
                setTimeout(function() {
                    // A biblioteca QRCode exp√µe como QRCode no escopo global
                    // Verificar m√∫ltiplas formas de acesso
                    var QRCodeLib = null;
                    
                    // Tentar diferentes formas de acesso
                    if (typeof QRCode !== 'undefined') {
                        QRCodeLib = QRCode;
                    } else if (typeof window.QRCode !== 'undefined') {
                        QRCodeLib = window.QRCode;
                    }
                    
                    if (QRCodeLib) {
                        window.QRCode = QRCodeLib;
                        window.qrcode = QRCodeLib;
                        window.qrcodeLoaded = true;
                        console.log('‚úÖ Biblioteca QRCode configurada e dispon√≠vel');
                    } else {
                        console.warn('‚ö†Ô∏è QRCode n√£o encontrado ap√≥s carregamento');
                        window.qrcodeLoaded = false;
                    }
                }, 100);
            };
            
            // Detectar se est√° rodando localmente ou no Vercel
            var isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            
            // Carregar QRCode
            (function() {
                // Verificar se j√° foi carregado
                if (window.qrcodeLoaded || (window.QRCode || window.qrcode)) {
                    console.log('‚úÖ Biblioteca QRCode j√° est√° dispon√≠vel');
                    return;
                }
                
                var qrScript = document.createElement('script');
                
                // No localhost, usar arquivo local; no Vercel, usar CDN
                if (isLocalhost) {
                    qrScript.src = '/lib/qrcode.min.js';
                    console.log('üì• Carregando QRCode do arquivo local...');
                } else {
                    // Usar CDN UMD que funciona no browser (sem require)
                    qrScript.src = 'https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js';
                    console.log('üì• Carregando QRCode do CDN (UMD)...');
                }
                
                qrScript.async = true;
                qrScript.onload = function() {
                    if (window.setupQRCode) {
                        window.setupQRCode();
                    } else {
                        setTimeout(function() {
                            if (window.setupQRCode) {
                                window.setupQRCode();
                            } else if (typeof QRCode !== 'undefined') {
                                window.QRCode = QRCode;
                                window.qrcode = QRCode;
                                window.qrcodeLoaded = true;
                                console.log('‚úÖ Biblioteca QRCode configurada');
                            }
                        }, 100);
                    }
                };
                qrScript.onerror = function() {
                    if (isLocalhost) {
                        // Se local falhar, tentar CDN
                        console.warn('‚ö†Ô∏è Arquivo local n√£o encontrado, tentando CDN...');
                        var cdnScript = document.createElement('script');
                        cdnScript.src = 'https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js';
                        cdnScript.async = true;
                        cdnScript.onload = function() {
                            if (window.setupQRCode) {
                                window.setupQRCode();
                            } else if (typeof QRCode !== 'undefined') {
                                window.QRCode = QRCode;
                                window.qrcode = QRCode;
                                window.qrcodeLoaded = true;
                            }
                        };
                        cdnScript.onerror = function() {
                            console.warn('‚ö†Ô∏è Funcionalidade de QRCode n√£o estar√° dispon√≠vel');
                            window.qrcodeLoaded = false;
                        };
                        document.head.appendChild(cdnScript);
                    } else {
                        // Se CDN falhar, tentar alternativas
                        console.warn('‚ö†Ô∏è CDN principal falhou, tentando alternativas...');
                        var altScript = document.createElement('script');
                        altScript.src = 'https://unpkg.com/qrcode@1.5.3/build/qrcode.min.js';
                        altScript.async = true;
                        altScript.onload = function() {
                            if (window.setupQRCode) {
                                window.setupQRCode();
                            } else if (typeof QRCode !== 'undefined') {
                                window.QRCode = QRCode;
                                window.qrcode = QRCode;
                                window.qrcodeLoaded = true;
                            }
                        };
                        altScript.onerror = function() {
                            console.warn('‚ö†Ô∏è Funcionalidade de QRCode n√£o estar√° dispon√≠vel');
                            window.qrcodeLoaded = false;
                        };
                        document.head.appendChild(altScript);
                    }
                };
                document.head.appendChild(qrScript);
            })();
        </script>
        <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
        <link rel="manifest" href="/manifest.json" />
        <link
            rel="icon"
            type="image/jpeg"
            sizes="192x192"
            href="/images/icone-e-transicao.jpg"
        />
        <link rel="apple-touch-icon" href="/images/icone-e-transicao.jpg" />
        <!-- Estilo inline para evitar FOUC - esconde conte√∫do at√© CSS carregar -->
        <style>
            body { visibility: hidden; opacity: 0; }
            body.loaded { visibility: visible; opacity: 1; transition: opacity 0.2s; }
        </style>
        <script>
            // Mostrar conte√∫do quando CSS carregar e aplicar anima√ß√£o de entrada
            window.addEventListener('load', function() {
                document.body.classList.add('loaded');
                
                // Aplicar anima√ß√£o de entrada na p√°gina de gerenciamento
                const appContainer = document.querySelector('.app-container');
                if (appContainer) {
                    // Pequeno delay para garantir que o CSS est√° carregado
                    setTimeout(() => {
                        appContainer.classList.add('animate-in');
                    }, 50);
                }
            });
        </script>
    </head>
    <body>
        <!-- Skip link para acessibilidade -->
        <a href="#main-content" class="skip-link">Pular para o conte√∫do principal</a>
        <div class="app-container">
            <header class="header">
                <h1>Gest√£o Financeira</h1>
                <div class="header-actions">
                    <button id="helpBtn" class="btn-secondary" title="Como usar" aria-label="Abrir ajuda e instru√ß√µes de uso">
                        <i class="fas fa-question-circle"></i> <span class="btn-text">Como usar</span>
                    </button>
                    <button id="themeToggleBtn" class="theme-toggle-btn" title="Alternar tema" aria-label="Alternar entre tema vermelho e azul">
                        <i class="fas fa-palette"></i>
                    </button>
                    <button id="voiceToggleBtn" class="btn-secondary" title="Ativar/Desativar Navega√ß√£o por Voz" aria-label="Alternar navega√ß√£o por voz" onclick="app.toggleVoiceRecognition()" style="display: none;">
                        <i class="fas fa-microphone"></i> <span class="btn-text">Voz</span>
                    </button>
                    <button id="darkModeToggle" class="dark-mode-toggle" title="Alternar modo escuro" aria-label="Alternar entre modo claro e escuro">
                        <i class="fas fa-sun icon-sun"></i>
                        <i class="fas fa-moon icon-moon"></i>
                    </button>
                    <button id="importBtn" class="btn-secondary" title="Importar Dados" aria-label="Importar dados do sistema">
                        <i class="fas fa-upload"></i> <span class="btn-text">Importar Dados</span>
                    </button>
                    <button id="exportBtn" class="btn-secondary" title="Exportar Dados" aria-label="Exportar dados do sistema" onclick="app.openExportModal()">
                        <i class="fas fa-download"></i> <span class="btn-text">Exportar Dados</span>
                    </button>
                    <button id="backupBtn" class="btn-secondary" title="Gerenciar Backups" aria-label="Gerenciar backups do sistema" onclick="app.openBackupModal()">
                        <i class="fas fa-database"></i> <span class="btn-text">Backups</span>
                    </button>
                    <input
                        type="file"
                        id="importFile"
                        accept=".txt"
                        style="display: none"
                    />
                    <button type="button" id="logoutBtn" class="btn-secondary" title="Sair" aria-label="Fazer logout e sair do sistema">
                        <i class="fas fa-sign-out-alt"></i> <span class="btn-text">Sair</span>
                    </button>
                </div>
            </header>

            <main class="main-content">
                <div class="toolbar" id="mainToolbar" style="display: none;">
                    <div class="search-filter">
                        <div class="search-filter-wrapper">
                            <i class="fas fa-search search-icon"></i>
                            <input
                                type="text"
                                id="searchInput"
                                class="search-input-with-icon"
                                placeholder="Pesquisar..."
                            />
                        </div>
                        <select id="monthFilter">
                            <option value="">Todos os meses</option>
                        </select>
                        <button class="btn-secondary" onclick="app.openAdvancedSearchModal()" title="Busca Avan√ßada" style="white-space: nowrap;">
                            <i class="fas fa-filter"></i> <span class="btn-text">Busca Avan√ßada</span>
                        </button>
                    </div>
                </div>

                <div class="content-tabs">
                    <!-- Dashboards agrupados -->
                    <button class="tab-btn" id="dashboardToggleBtn" data-tab="dashboard" title="Dashboards" aria-label="Abrir painel de dashboards">
                        <i class="fas fa-chart-line"></i> <span class="btn-text">Dashboards</span>
                    </button>
                    <button class="tab-btn" data-tab="salesPanel" title="Painel de Vendas" aria-label="Abrir painel de vendas">
                        <i class="fas fa-shopping-cart"></i> <span class="btn-text">Painel de Vendas</span>
                    </button>
                    <button class="tab-btn" data-tab="servicesPanel" title="Painel de Servi√ßos" aria-label="Abrir painel de servi√ßos">
                        <i class="fas fa-briefcase"></i> <span class="btn-text">Painel de Servi√ßos</span>
                    </button>
                    <button class="tab-btn" data-tab="goals" title="Metas" aria-label="Abrir painel de metas">
                        <i class="fas fa-bullseye"></i> <span class="btn-text">Metas</span>
                    </button>
                    <!-- Aba de Administra√ß√£o (apenas para admin) -->
                    <button class="tab-btn" id="adminTabBtn" data-tab="adminPanel" title="Administra√ß√£o" style="display: none;">
                        <i class="fas fa-shield-alt"></i> <span class="btn-text">Administra√ß√£o</span>
                    </button>
                </div>

                <!-- Tab: Painel de Vendas -->
                <div id="salesPanelTab" class="tab-content">
                    <div class="sales-panel-layout">
                        <!-- Se√ß√£o de Grupos Mensais -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-calendar-check"></i> Grupos Mensais</h2>
                                <button class="btn-primary" onclick="app.openGroupModal()">
                                    <i class="fas fa-plus"></i> Novo M√™s
                                </button>
                            </div>
                            <div class="panel-filters" style="margin-bottom: 1.5rem; display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                                <div class="filter-group" style="display: flex; align-items: center; gap: 0.5rem;">
                                    <label for="yearFilter" style="font-weight: 600; color: var(--gray-700); font-size: 0.9rem;">Filtrar por Ano:</label>
                                    <select id="yearFilter" class="filter-select" style="padding: 0.5rem 1rem; border-radius: var(--radius-md); border: 1px solid var(--gray-300); background: var(--white); color: var(--dark-gray); font-size: 0.9rem; cursor: pointer; transition: all var(--transition-base);">
                                        <option value="">Todos os anos</option>
                                    </select>
                                </div>
                            </div>
                            <div id="groupsList" class="groups-list">
                                <!-- Grupos mensais ser√£o inseridos aqui via JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Se√ß√£o de Produtos -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-box"></i> Produtos</h2>
                                <button class="btn-primary" onclick="app.openItemModal()">
                                    <i class="fas fa-plus"></i> Novo Produto
                                </button>
                            </div>
                            <div class="panel-filters" style="margin-bottom: 1rem; display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                                <div class="filter-group" style="display: flex; align-items: center; gap: 0.5rem; flex: 1; min-width: 250px;">
                                    <i class="fas fa-search" style="color: var(--gray-400);"></i>
                                    <input type="text" id="searchInput" class="search-input-with-icon" placeholder="Buscar produtos (inclui notas)..." style="flex: 1;">
                                </div>
                                <div class="filter-group" style="display: flex; align-items: center; gap: 0.5rem;">
                                    <label for="tagFilter" style="font-size: 0.875rem; color: var(--gray-600); white-space: nowrap;">
                                        <i class="fas fa-tags"></i> Filtrar por tag:
                                    </label>
                                    <select id="tagFilter" class="search-input-with-icon" style="min-width: 150px;">
                                        <option value="">Todas as tags</option>
                                    </select>
                                </div>
                                <div class="filter-group" style="display: flex; align-items: center; gap: 0.5rem;">
                                    <button class="btn-secondary" onclick="app.openNotesSearchModal()" title="Buscar por Notas">
                                        <i class="fas fa-sticky-note"></i> <span class="btn-text">Buscar Notas</span>
                                    </button>
                                </div>
                            </div>
                            <div id="itemsGrid" class="items-grid">
                                <!-- Produtos ser√£o inseridos aqui via JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Se√ß√£o de Clientes -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-users"></i> Clientes</h2>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button class="btn-secondary" onclick="app.exportClients()" title="Exportar Lista de Clientes">
                                        <i class="fas fa-download"></i> <span class="btn-text">Exportar</span>
                                    </button>
                                    <button class="btn-primary" onclick="app.openClientModal()">
                                        <i class="fas fa-plus"></i> Novo Cliente
                                    </button>
                                </div>
                            </div>
                            <div class="panel-filters" style="margin-bottom: 1rem; display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                                <div class="filter-group" style="display: flex; align-items: center; gap: 0.5rem; flex: 1; min-width: 250px;">
                                    <i class="fas fa-search" style="color: var(--gray-400);"></i>
                                    <input type="text" id="clientSearch" class="search-input-with-icon" placeholder="Buscar cliente por nome, CPF ou telefone..." style="flex: 1;">
                                </div>
                            </div>
                            <div id="clientsList" class="items-grid">
                                <!-- Clientes ser√£o inseridos aqui via JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Se√ß√£o de Fornecedores -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-truck"></i> Fornecedores</h2>
                                <button class="btn-primary" onclick="app.openSupplierModal()">
                                    <i class="fas fa-plus"></i> Novo Fornecedor
                                </button>
                            </div>
                            <div class="panel-filters" style="margin-bottom: 1rem; display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                                <div class="filter-group" style="display: flex; align-items: center; gap: 0.5rem; flex: 1; min-width: 250px;">
                                    <i class="fas fa-search" style="color: var(--gray-400);"></i>
                                    <input type="text" id="supplierSearch" class="search-input-with-icon" placeholder="Buscar fornecedor por nome, CNPJ ou telefone..." style="flex: 1;">
                                </div>
                            </div>
                            <div id="suppliersList" class="items-grid">
                                <!-- Fornecedores ser√£o inseridos aqui via JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Se√ß√£o de Templates -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-file-alt"></i> Templates</h2>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button class="btn-secondary" onclick="app.exportTemplates()" title="Exportar Templates">
                                        <i class="fas fa-download"></i> <span class="btn-text">Exportar</span>
                                    </button>
                                    <button class="btn-secondary" onclick="document.getElementById('importTemplatesFile').click()" title="Importar Templates">
                                        <i class="fas fa-upload"></i> <span class="btn-text">Importar</span>
                                    </button>
                                    <input type="file" id="importTemplatesFile" accept=".json,.txt" style="display: none;" onchange="app.importTemplates(event)" />
                                    <button class="btn-primary" onclick="app.openTemplateModal()">
                                        <i class="fas fa-plus"></i> Novo Template
                                    </button>
                                </div>
                            </div>
                            <div id="templatesList" class="items-grid">
                                <!-- Templates ser√£o inseridos aqui via JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Se√ß√£o de Cupons de Desconto -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-tag"></i> Cupons de Desconto</h2>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button class="btn-secondary" onclick="app.openPromotionHistoryModal()" title="Hist√≥rico de Promo√ß√µes">
                                        <i class="fas fa-history"></i> <span class="btn-text">Hist√≥rico</span>
                                    </button>
                                    <button class="btn-primary" onclick="app.openCouponModal()">
                                        <i class="fas fa-plus"></i> Novo Cupom
                                    </button>
                                </div>
                            </div>
                            <div id="couponsList" class="items-grid">
                                <!-- Cupons ser√£o inseridos aqui via JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Se√ß√£o de Pedidos Pendentes -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-clock"></i> Pedidos Pendentes</h2>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button class="btn-secondary" onclick="app.openReceiptSearchModal()" title="Buscar Comprovantes">
                                        <i class="fas fa-search"></i> <span class="btn-text">Buscar Comprovantes</span>
                                    </button>
                                    <button class="btn-primary" onclick="app.openPendingOrderModal()">
                                        <i class="fas fa-plus"></i> Novo Pedido
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Carrossel de √öltimos Comprovantes -->
                            <div class="last-receipts-section" style="margin-bottom: 2rem;">
                                <h3 style="margin: 0 0 1rem 0; color: var(--primary-color); font-size: 1.1rem; font-weight: 600;">
                                    <i class="fas fa-receipt"></i> √öltimos Comprovantes
                                </h3>
                                <div id="lastReceiptsCarousel" class="last-receipts-carousel">
                                    <!-- Carrossel ser√° preenchido via JavaScript -->
                                </div>
                            </div>
                            
                            <div id="pendingOrdersList" class="pending-orders-list">
                                <!-- Pedidos pendentes ser√£o inseridos aqui via JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Se√ß√£o de Custos de Compra -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-receipt"></i> Custos de Compra</h2>
                                <button class="btn-primary" onclick="app.openCostModal()">
                                    <i class="fas fa-plus"></i> Novo Custo
                                </button>
                            </div>
                            <div class="costs-layout">
                                <div class="costs-summary-card">
                                    <h3>Resumo de Custos</h3>
                                    <div class="summary-stats">
                                        <div class="stat-item">
                                            <h4>Total de Custos</h4>
                                            <p id="totalCostsCount">0</p>
                                        </div>
                                        <div class="stat-item">
                                            <h4>Valor Total</h4>
                                            <p id="totalCostsValue">R$ 0,00</p>
                                        </div>
                                    </div>
                                    
                                    <!-- Gr√°fico de Custos -->
                                    <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
                                        <h4 style="margin-bottom: 1rem; font-size: 1rem; color: var(--gray-600);">Evolu√ß√£o de Custos</h4>
                                        <div class="chart-wrapper" style="height: 200px;">
                                            <canvas id="costsChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                                <div class="costs-content">
                                    <div id="costsList" class="costs-list">
                                        <!-- Custos ser√£o inseridos aqui via JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab: Dashboard Vendas -->
                <div id="dashboardTab" class="tab-content">
                    <div class="dashboard-container">
                        <div class="dashboard-filters">
                            <div class="filter-group">
                                <label for="periodFilter">Per√≠odo:</label>
                                <select id="periodFilter" class="filter-select">
                                    <option value="all">Todos os per√≠odos</option>
                                    <option value="month">√öltimo m√™s</option>
                                    <option value="3months">√öltimos 3 meses</option>
                                    <option value="6months">√öltimos 6 meses</option>
                                    <option value="year">√öltimo ano</option>
                                </select>
                            </div>
                            <button type="button" class="btn-secondary" onclick="app.openReportBuilderModal()" title="Gerar Relat√≥rio Personalizado">
                                <i class="fas fa-file-alt"></i> <span class="btn-text">Gerar Relat√≥rio</span>
                            </button>
                            <button type="button" class="btn-secondary" onclick="app.openPredictiveAnalysisModal()" title="An√°lise Preditiva">
                                <i class="fas fa-chart-line"></i> <span class="btn-text">An√°lise Preditiva</span>
                            </button>
                            <button type="button" class="btn-secondary" onclick="app.openCompetitiveAnalysisModal()" title="An√°lise de Concorr√™ncia">
                                <i class="fas fa-chart-bar"></i> <span class="btn-text">An√°lise de Concorr√™ncia</span>
                            </button>
                            <button type="button" class="btn-secondary" id="refreshDashboard">
                                <i class="fas fa-sync-alt"></i> Atualizar Gr√°ficos
                            </button>
                        </div>

                        <div class="charts-grid">
                            <div class="chart-card">
                                <h3>Vendas por M√™s</h3>
                                <div class="chart-wrapper">
                                    <canvas id="salesByMonthChart"></canvas>
                                </div>
                            </div>

                            <div class="chart-card">
                                <h3>Lucro vs Custos</h3>
                                <div class="chart-wrapper">
                                    <canvas id="profitVsCostsChart"></canvas>
                                </div>
                            </div>

                            <div class="chart-card">
                                <h3>Top 10 Itens Mais Vendidos</h3>
                                <div class="chart-wrapper">
                                    <canvas id="topItemsChart"></canvas>
                                </div>
                            </div>

                            <div class="chart-card">
                                <h3>Evolu√ß√£o do Lucro</h3>
                                <div class="chart-wrapper">
                                    <canvas id="profitEvolutionChart"></canvas>
                                </div>
                            </div>

                            <div class="chart-card">
                                <h3>Consumo de Estoque por M√™s</h3>
                                <div class="chart-wrapper">
                                    <canvas id="stockConsumptionChart"></canvas>
                                </div>
                            </div>

                            <div class="chart-card">
                                <h3>Top 10 Itens em Rotatividade</h3>
                                <div class="chart-wrapper">
                                    <canvas id="stockRotationChart"></canvas>
                                </div>
                            </div>
                        </div>

                        <div class="dashboard-stats">
                            <div class="stat-card">
                                <h4>M√©dia Mensal de Vendas</h4>
                                <p id="avgMonthlySales">R$ 0,00</p>
                            </div>
                            <div class="stat-card">
                                <h4>Melhor M√™s</h4>
                                <p id="bestMonth">-</p>
                            </div>
                            <div class="stat-card">
                                <h4>Margem de Lucro M√©dia</h4>
                                <p id="avgProfitMargin">0%</p>
                            </div>
                            <div class="stat-card">
                                <h4>Total de Itens Cadastrados</h4>
                                <p id="totalItemsCount">0</p>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Tab: Dashboard Servi√ßos -->
                <div id="servicesDashboardTab" class="tab-content">
                    <div class="dashboard-container">
                        <div class="dashboard-filters">
                            <div class="filter-group">
                                <label for="servicesPeriodFilter">Per√≠odo:</label>
                                <select id="servicesPeriodFilter" class="filter-select">
                                    <option value="all">Todos os per√≠odos</option>
                                    <option value="month">√öltimo m√™s</option>
                                    <option value="3months">√öltimos 3 meses</option>
                                    <option value="6months">√öltimos 6 meses</option>
                                    <option value="year">√öltimo ano</option>
                                </select>
                            </div>
                            <button type="button" class="btn-secondary" id="refreshServicesDashboard">
                                <i class="fas fa-sync-alt"></i> Atualizar Gr√°ficos
                            </button>
                        </div>

                        <div class="charts-grid">
                            <div class="chart-card">
                                <h3>Horas Trabalhadas por M√™s</h3>
                                <div class="chart-wrapper">
                                    <canvas id="hoursByMonthChart"></canvas>
                                </div>
                            </div>

                            <div class="chart-card">
                                <h3>Faturamento por M√™s</h3>
                                <div class="chart-wrapper">
                                    <canvas id="revenueByMonthChart"></canvas>
                                </div>
                            </div>

                            <div class="chart-card">
                                <h3>Top 10 Servi√ßos Mais Prestados</h3>
                                <div class="chart-wrapper">
                                    <canvas id="topServicesChart"></canvas>
                                </div>
                            </div>

                            <div class="chart-card">
                                <h3>Evolu√ß√£o de Horas Trabalhadas</h3>
                                <div class="chart-wrapper">
                                    <canvas id="hoursEvolutionChart"></canvas>
                                </div>
                            </div>

                            <div class="chart-card">
                                <h3>M√©dia de Horas por Dia</h3>
                                <div class="chart-wrapper">
                                    <canvas id="avgHoursPerDayChart"></canvas>
                                </div>
                            </div>

                            <div class="chart-card">
                                <h3>Valor M√©dio por Hora</h3>
                                <div class="chart-wrapper">
                                    <canvas id="avgValuePerHourChart"></canvas>
                                </div>
                            </div>
                        </div>

                        <div class="dashboard-stats">
                            <div class="stat-card">
                                <h4>M√©dia Mensal de Horas</h4>
                                <p id="servicesAvgMonthlyHours">0h 0min</p>
                            </div>
                            <div class="stat-card">
                                <h4>Melhor M√™s (Horas)</h4>
                                <p id="servicesBestMonthHours">-</p>
                            </div>
                            <div class="stat-card">
                                <h4>M√©dia Mensal de Faturamento</h4>
                                <p id="servicesAvgMonthlyRevenue">R$ 0,00</p>
                            </div>
                            <div class="stat-card">
                                <h4>Melhor M√™s (Faturamento)</h4>
                                <p id="servicesBestMonthRevenue">-</p>
                            </div>
                            <div class="stat-card">
                                <h4>Valor M√©dio por Hora</h4>
                                <p id="servicesDashboardAvgValuePerHour">R$ 0,00</p>
                            </div>
                            <div class="stat-card">
                                <h4>Total de Servi√ßos Prestados</h4>
                                <p id="servicesDashboardTotalServices">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab: Painel de Servi√ßos -->
                <div id="servicesPanelTab" class="tab-content">
                    <div class="services-panel-layout">
                        <!-- Se√ß√£o de Agenda de Servi√ßos -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-calendar-alt"></i> Agenda de Servi√ßos</h2>
                                <button class="btn-primary" onclick="app.openServiceAppointmentModal()">
                                    <i class="fas fa-plus"></i> Novo Agendamento
                                </button>
                            </div>
                            <!-- Mini Calend√°rio -->
                            <div id="miniCalendarContainer" class="mini-calendar-container">
                                <!-- Mini calend√°rio ser√° inserido aqui via JavaScript -->
                            </div>
                            <div id="serviceAppointmentsList" class="service-appointments-list">
                                <!-- Agendamentos ser√£o inseridos aqui via JavaScript -->
                            </div>
                        </div>
                    </div>
                    <div class="services-layout">
                        <div class="overall-summary-card">
                            <h3>Resumo de Servi√ßos</h3>
                            <div class="summary-stats">
                                <div class="stat-item">
                                    <h4>Total de Horas</h4>
                                    <p id="servicesTotalHours">0h 0min</p>
                                </div>
                                <div class="stat-item">
                                    <h4>M√©dia de Horas/M√™s</h4>
                                    <p id="servicesAvgHours">0h 0min</p>
                                </div>
                                <div class="stat-item" style="background: #fff3cd; border: 1px solid #ffc107;">
                                    <h4>Total Faturado</h4>
                                    <p id="servicesTotalRevenue" style="color: #856404">R$ 0,00</p>
                                </div>
                                <div class="stat-item" style="background: #d4edda; border: 1px solid #28a745;">
                                    <h4>Servi√ßos Registrados</h4>
                                    <p id="servicesTotalCount" style="color: #155724; font-size: 1.6rem;">0</p>
                                </div>
                                <div class="stat-item" style="background: #e7f3ff; border: 1px solid #007bff;">
                                    <h4>Valor M√©dio por Hora</h4>
                                    <p id="servicesAvgValuePerHour" style="color: #004085;">R$ 0,00</p>
                                </div>
                                <div class="stat-item" style="background: #f8d7da; border: 1px solid #dc3545;">
                                    <h4>M√©dia de Horas por Servi√ßo</h4>
                                    <p id="servicesAvgHoursPerService" style="color: #721c24;">0h 0min</p>
                                </div>
                            </div>
                            
                            <!-- Gr√°fico de Servi√ßos -->
                            <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
                                <h4 style="margin-bottom: 1rem; font-size: 1rem; color: var(--gray-600);">Evolu√ß√£o de Servi√ßos por M√™s</h4>
                                <div class="chart-wrapper" style="height: 200px;">
                                    <canvas id="servicesChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="groups-content">
                            <div class="toolbar">
                                <button type="button" id="newServiceGroupBtn" class="btn-primary">
                                    <i class="fas fa-calendar-plus"></i> Novo M√™s de Servi√ßos
                                </button>
                            </div>
                            <div class="panel-filters" style="margin-bottom: 1.5rem; display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                                <div class="filter-group" style="display: flex; align-items: center; gap: 0.5rem;">
                                    <label for="servicesYearFilter" style="font-weight: 600; color: var(--gray-700); font-size: 0.9rem;">Filtrar por Ano:</label>
                                    <select id="servicesYearFilter" class="filter-select" style="padding: 0.5rem 1rem; border-radius: var(--radius-md); border: 1px solid var(--gray-300); background: var(--white); color: var(--dark-gray); font-size: 0.9rem; cursor: pointer; transition: all var(--transition-base);">
                                        <option value="">Todos os anos</option>
                                    </select>
                                </div>
                            </div>
                            <div id="servicesList" class="groups-list">
                                <!-- Servi√ßos mensais ser√£o inseridos aqui via JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab: Metas -->
                <div id="goalsTab" class="tab-content">
                    <div class="goals-layout">
                        <div class="goals-summary-card">
                            <h3>Resumo de Metas</h3>
                            <div class="summary-stats">
                                <div class="stat-item">
                                    <h4>Meta do M√™s Atual</h4>
                                    <p id="currentMonthGoal">R$ 0,00</p>
                                </div>
                                <div class="stat-item">
                                    <h4>Vendas do M√™s</h4>
                                    <p id="currentMonthSales">R$ 0,00</p>
                                </div>
                                <div class="stat-item" id="goalProgressItem">
                                    <h4>Progresso</h4>
                                    <p id="goalProgress">0%</p>
                                </div>
                                <div class="stat-item" id="goalStatusItem">
                                    <h4>Status</h4>
                                    <p id="goalStatus">-</p>
                                </div>
                            </div>
                            
                            <!-- Gr√°fico de Metas -->
                            <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
                                <h4 style="margin-bottom: 1rem; font-size: 1rem; color: var(--gray-600);">Evolu√ß√£o de Metas vs Vendas</h4>
                                <div class="chart-wrapper" style="height: 200px;">
                                    <canvas id="goalsChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="goals-content">
                            <div class="toolbar-goals">
                                <button type="button" id="newGoalBtn" class="btn-primary">
                                    <i class="fas fa-bullseye"></i> Criar Nova Meta
                                </button>
                            </div>
                            <div class="panel-filters" style="margin-bottom: 1.5rem; display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                                <div class="filter-group" style="display: flex; align-items: center; gap: 0.5rem;">
                                    <label for="goalsYearFilter" style="font-weight: 600; color: var(--gray-700); font-size: 0.9rem;">Filtrar por Ano:</label>
                                    <select id="goalsYearFilter" class="filter-select" style="padding: 0.5rem 1rem; border-radius: var(--radius-md); border: 1px solid var(--gray-300); background: var(--white); color: var(--dark-gray); font-size: 0.9rem; cursor: pointer; transition: all var(--transition-base);">
                                        <option value="">Todos os anos</option>
                                    </select>
                                </div>
                            </div>
                            <div id="goalsList" class="goals-list">
                                <!-- Metas ser√£o inseridas aqui via JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab: Administra√ß√£o (apenas para admin) -->
                <div id="adminPanelTab" class="tab-content">
                    <div class="admin-panel-layout">
                        <!-- Dashboard de Uso Total do Banco de Dados -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-database"></i> Dashboard de Uso Total do Banco de Dados</h2>
                                <button class="btn-secondary" onclick="app.refreshAdminData()" title="Atualizar Dados">
                                    <i class="fas fa-sync-alt"></i> <span class="btn-text">Atualizar</span>
                                </button>
                            </div>
                            <div id="adminTotalUsageDashboard" class="admin-dashboard-content">
                                <!-- Dashboard ser√° preenchido via JavaScript -->
                            </div>
                        </div>

                        <!-- Dashboard de Uso do Banco por Usu√°rio -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-users"></i> Dashboard de Uso do Banco por Usu√°rio</h2>
                            </div>
                            <div id="adminUsersUsageDashboard" class="admin-dashboard-content">
                                <!-- Dashboard ser√° preenchido via JavaScript -->
                            </div>
                        </div>

                        <!-- Se√ß√£o LGPD Compliance -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-shield-alt"></i> LGPD Compliance</h2>
                            </div>
                            <div style="padding: 1.5rem;">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                                    <button class="btn-secondary" onclick="app.openPrivacyPolicyModal()" style="width: 100%;">
                                        <i class="fas fa-file-contract"></i> Pol√≠tica de Privacidade
                                    </button>
                                    <button class="btn-secondary" onclick="app.exportPersonalData()" style="width: 100%;">
                                        <i class="fas fa-download"></i> Exportar Meus Dados
                                    </button>
                                    <button class="btn-secondary" onclick="app.viewDataAccessLogs()" style="width: 100%;">
                                        <i class="fas fa-history"></i> Logs de Acesso
                                    </button>
                                    <button class="btn-danger" onclick="app.requestDataDeletion()" style="width: 100%;">
                                        <i class="fas fa-trash-alt"></i> Solicitar Exclus√£o de Dados
                                    </button>
                                </div>
                                
                                <div id="lgpdStatus" style="padding: 1rem; background: var(--light-gray); border-radius: var(--radius-sm); margin-bottom: 1rem;">
                                    <h3 style="margin: 0 0 0.5rem 0; font-size: 1rem; color: var(--dark-gray);">Status de Consentimento</h3>
                                    <p id="cookieConsentStatus" style="margin: 0; color: var(--gray-700); font-size: 0.9rem;">-</p>
                                </div>
                            </div>
                        </div>

                        <!-- Se√ß√£o Acessibilidade -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-universal-access"></i> Acessibilidade</h2>
                            </div>
                            <div style="padding: 1.5rem;">
                                <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                    <button class="btn-secondary" onclick="app.openAccessibilityModal()" style="width: 100%;">
                                        <i class="fas fa-cog"></i> Configura√ß√µes de Acessibilidade
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Calculadora Financeira -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-calculator"></i> Calculadora Financeira</h2>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 1rem;">
                                <!-- ROI por Produto -->
                                <div style="border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 1.5rem;">
                                    <h3 style="margin: 0 0 1rem 0; color: var(--primary-color); font-size: 1.1rem;">
                                        <i class="fas fa-chart-line"></i> ROI por Produto
                                    </h3>
                                    <div class="form-group">
                                        <label for="roiProductSelect">Selecione o Produto</label>
                                        <select id="roiProductSelect" class="search-input-with-icon" onchange="app.calculateProductROI()">
                                            <option value="">Selecione um produto...</option>
                                        </select>
                                    </div>
                                    <div id="roiResults" style="margin-top: 1rem; padding: 1rem; background: var(--light-gray); border-radius: var(--radius-sm); display: none;">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                                            <div>
                                                <p style="margin: 0; font-size: 0.85rem; color: var(--gray-600);">Pre√ßo de Venda</p>
                                                <p style="margin: 0.25rem 0 0 0; font-size: 1.2rem; font-weight: 600; color: var(--primary-color);" id="roiSalePrice">R$ 0,00</p>
                                            </div>
                                            <div>
                                                <p style="margin: 0; font-size: 0.85rem; color: var(--gray-600);">Custo</p>
                                                <p style="margin: 0.25rem 0 0 0; font-size: 1.2rem; font-weight: 600; color: var(--gray-700);" id="roiCost">R$ 0,00</p>
                                            </div>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                                            <div>
                                                <p style="margin: 0; font-size: 0.85rem; color: var(--gray-600);">Lucro Unit√°rio</p>
                                                <p style="margin: 0.25rem 0 0 0; font-size: 1.2rem; font-weight: 600; color: #28a745;" id="roiProfit">R$ 0,00</p>
                                            </div>
                                            <div>
                                                <p style="margin: 0; font-size: 0.85rem; color: var(--gray-600);">Margem de Lucro</p>
                                                <p style="margin: 0.25rem 0 0 0; font-size: 1.2rem; font-weight: 600; color: #28a745;" id="roiMargin">0%</p>
                                            </div>
                                        </div>
                                        <div style="padding-top: 1rem; border-top: 1px solid var(--border-color);">
                                            <p style="margin: 0; font-size: 0.85rem; color: var(--gray-600);">ROI (Return on Investment)</p>
                                            <p style="margin: 0.25rem 0 0 0; font-size: 1.5rem; font-weight: 700; color: var(--primary-color);" id="roiValue">0%</p>
                                            <small style="color: var(--gray-600); font-size: 0.75rem; display: block; margin-top: 0.25rem;">
                                                Retorno sobre o investimento
                                            </small>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Simulador de Pre√ßos -->
                                <div style="border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 1.5rem;">
                                    <h3 style="margin: 0 0 1rem 0; color: var(--primary-color); font-size: 1.1rem;">
                                        <i class="fas fa-sliders-h"></i> Simulador de Pre√ßos
                                    </h3>
                                    <div class="form-group">
                                        <label for="simulatorCost">Custo de Compra (R$)</label>
                                        <input type="number" id="simulatorCost" step="0.01" min="0" placeholder="0.00" oninput="app.simulatePrice()" />
                                    </div>
                                    <div class="form-group">
                                        <label for="simulatorMargin">Margem de Lucro Desejada (%)</label>
                                        <input type="number" id="simulatorMargin" step="0.1" min="0" max="100" value="30" oninput="app.simulatePrice()" />
                                    </div>
                                    <div class="form-group">
                                        <label for="simulatorDiscount">Desconto a Aplicar (%)</label>
                                        <input type="number" id="simulatorDiscount" step="0.1" min="0" max="100" value="0" oninput="app.simulatePrice()" />
                                    </div>
                                    <div id="simulatorResults" style="margin-top: 1rem; padding: 1rem; background: var(--light-gray); border-radius: var(--radius-sm);">
                                        <div style="margin-bottom: 1rem;">
                                            <p style="margin: 0; font-size: 0.85rem; color: var(--gray-600);">Pre√ßo de Venda Sugerido</p>
                                            <p style="margin: 0.25rem 0 0 0; font-size: 1.5rem; font-weight: 700; color: var(--primary-color);" id="simulatorPrice">R$ 0,00</p>
                                        </div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                                            <div>
                                                <p style="margin: 0; font-size: 0.85rem; color: var(--gray-600);">Lucro Esperado</p>
                                                <p style="margin: 0.25rem 0 0 0; font-size: 1.1rem; font-weight: 600; color: #28a745;" id="simulatorProfit">R$ 0,00</p>
                                            </div>
                                            <div>
                                                <p style="margin: 0; font-size: 0.85rem; color: var(--gray-600);">Pre√ßo com Desconto</p>
                                                <p style="margin: 0.25rem 0 0 0; font-size: 1.1rem; font-weight: 600; color: var(--gray-700);" id="simulatorFinalPrice">R$ 0,00</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Hist√≥rico de Atividades (Audit Log) -->
                        <div class="panel-section">
                            <div class="panel-header">
                                <h2><i class="fas fa-history"></i> Hist√≥rico de Atividades</h2>
                                <div style="display: flex; gap: 0.5rem;">
                                    <select id="auditLogFilter" class="search-input-with-icon" style="min-width: 150px;">
                                        <option value="all">Todas as a√ß√µes</option>
                                        <option value="create">Criar</option>
                                        <option value="update">Atualizar</option>
                                        <option value="delete">Excluir</option>
                                        <option value="export">Exportar</option>
                                    </select>
                                    <select id="auditLogEntityFilter" class="search-input-with-icon" style="min-width: 150px;">
                                        <option value="all">Todas as entidades</option>
                                        <option value="item">Produtos</option>
                                        <option value="client">Clientes</option>
                                        <option value="supplier">Fornecedores</option>
                                        <option value="coupon">Cupons</option>
                                    </select>
                                </div>
                            </div>
                            <div id="auditLogList" class="items-grid" style="max-height: 600px; overflow-y: auto;">
                                <!-- Hist√≥rico ser√° inserido aqui via JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <footer class="footer">
                <p class="footer-text-cursive">Gerenciamento</p>
            </footer>
        </div>

        <!-- Modal: Cadastro/Edi√ß√£o de Item -->
        <div id="itemModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalTitle">Novo Produto</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="itemForm">
                    <div class="form-group">
                        <label for="itemCategory">Categoria *</label>
                        <select id="itemCategory" required>
                            <option value="">Selecione...</option>
                            <option value="Roupas">Roupas</option>
                            <option value="Eletr√¥nicos">Eletr√¥nicos</option>
                        </select>
                    </div>
                    <!-- Campos para Roupas (Nome e Marca) -->
                    <div id="clothingBasicFields">
                        <div class="form-group">
                            <label for="itemName">Nome da Roupa (opcional)</label>
                            <input type="text" id="itemName" placeholder="Ex: Camiseta, Cal√ßa, etc." />
                        </div>
                        <div class="form-group">
                            <label for="itemBrand">Marca *</label>
                            <input type="text" id="itemBrand" required />
                        </div>
                    </div>
                    
                    <!-- Campos espec√≠ficos para Roupas -->
                    <div id="clothingFields" class="category-specific-fields" style="display: none;">
                        <div class="form-group">
                            <label for="itemStyle">Estilo da Roupa (opcional)</label>
                            <input type="text" id="itemStyle" placeholder="Ex: Casual, Esportivo, Social, etc." />
                        </div>
                        <div class="form-group">
                            <label for="itemSize">Tamanho (opcional)</label>
                            <input type="text" id="itemSize" placeholder="Ex: P, M, G, 42, etc." />
                        </div>
                        <div class="form-group">
                            <label for="itemGender">G√™nero (opcional)</label>
                            <select id="itemGender">
                                <option value="">Selecione...</option>
                                <option value="Masculino">Masculino</option>
                                <option value="Feminino">Feminino</option>
                                <option value="Unissex">Unissex</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Campos espec√≠ficos para Eletr√¥nicos -->
                    <div id="electronicsFields" class="category-specific-fields" style="display: none;">
                        <div class="form-group">
                            <label for="itemModel">Modelo (opcional)</label>
                            <input type="text" id="itemModel" placeholder="Ex: iPhone 14, Galaxy S23, etc." />
                        </div>
                        <div class="form-group">
                            <label for="itemCapacity">Capacidade (opcional)</label>
                            <input type="text" id="itemCapacity" placeholder="Ex: 128GB, 256GB, 512GB, etc." />
                        </div>
                        <div class="form-group">
                            <label for="itemColor">Cor (opcional)</label>
                            <input type="text" id="itemColor" placeholder="Ex: Preto, Branco, Azul, etc." />
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemPrice">Pre√ßo de Venda *</label>
                        <input
                            type="number"
                            id="itemPrice"
                            step="0.01"
                            min="0.01"
                            required
                        />
                    </div>
                    <div class="form-group">
                        <label for="itemCost">Custo de Compra (opcional)</label>
                        <input
                            type="number"
                            id="itemCost"
                            step="0.01"
                            min="0"
                            placeholder="0.00"
                        />
                        <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                            Custo de aquisi√ß√£o do produto para c√°lculo de ROI e margem de lucro
                        </small>
                    </div>
                    <div class="form-group">
                        <label for="itemMinStock">Estoque M√≠nimo (opcional)</label>
                        <input
                            type="number"
                            id="itemMinStock"
                            min="0"
                            placeholder="Padr√£o: 5 unidades"
                        />
                        <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                            Quantidade m√≠nima antes de gerar alerta. Deixe em branco para usar o padr√£o (5 unidades).
                        </small>
                    </div>
                    <!-- QR Code Section -->
                    <div class="form-group" id="qrcodeSection" style="display: none; background: var(--light-gray); padding: 1rem; border-radius: 5px; margin-top: 1rem;">
                        <label style="margin-bottom: 0.5rem; display: block;">QR Code do Produto</label>
                        <div id="qrcodeContainer" style="text-align: center;">
                            <canvas id="qrcodeCanvas" style="max-width: 100%; height: auto;"></canvas>
                            <div style="margin-top: 1rem; display: flex; gap: 0.5rem; justify-content: center;">
                                <button type="button" class="btn-secondary" id="downloadQRBtn">
                                    <i class="fas fa-download"></i> Baixar
                                </button>
                                <button type="button" class="btn-secondary" id="printQRBtn">
                                    <i class="fas fa-print"></i> Imprimir
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button
                            type="button"
                            class="btn-secondary"
                            id="cancelBtn"
                        >
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            Salvar
                        </button>
                    </div>
                </form>
            </div>
        </div>


        <!-- Modal: Cadastro/Edi√ß√£o de Cliente -->
        <div id="clientModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="clientModalTitle">Novo Cliente</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="clientForm">
                    <div class="form-group">
                        <label for="clientName">Nome Completo *</label>
                        <input type="text" id="clientName" required placeholder="Ex: Jo√£o Silva" />
                    </div>
                    <div class="form-group">
                        <label for="clientCPF">CPF</label>
                        <input type="text" id="clientCPF" placeholder="000.000.000-00" maxlength="14" />
                    </div>
                    <div class="form-group">
                        <label for="clientPhone">Telefone</label>
                        <input type="text" id="clientPhone" placeholder="(00) 00000-0000" maxlength="15" />
                    </div>
                    <div class="form-group">
                        <label for="clientEmail">E-mail</label>
                        <input type="email" id="clientEmail" placeholder="cliente@email.com" />
                    </div>
                    <div class="form-group">
                        <label for="clientAddress">Endere√ßo</label>
                        <textarea id="clientAddress" rows="3" placeholder="Rua, n√∫mero, bairro, cidade - CEP"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="clientNotes">Observa√ß√µes</label>
                        <textarea id="clientNotes" rows="2" placeholder="Informa√ß√µes adicionais sobre o cliente"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="clientLoyaltyPoints">Pontos de Fidelidade</label>
                        <input type="number" id="clientLoyaltyPoints" min="0" value="0" placeholder="0" />
                        <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                            Pontos acumulados pelo cliente. Descontos autom√°ticos podem ser aplicados baseados nos pontos.
                        </small>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="clientReceiveNotifications" />
                            <span>Cliente deseja receber notifica√ß√µes</span>
                        </label>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" onclick="app.closeClientModal()">
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Salvar Cliente
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Cadastro/Edi√ß√£o de Fornecedor -->
        <div id="supplierModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="supplierModalTitle">Novo Fornecedor</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="supplierForm">
                    <div class="form-group">
                        <label for="supplierName">Nome/Raz√£o Social *</label>
                        <input type="text" id="supplierName" required placeholder="Ex: Fornecedor ABC Ltda" />
                    </div>
                    <div class="form-group">
                        <label for="supplierCNPJ">CNPJ</label>
                        <input type="text" id="supplierCNPJ" placeholder="00.000.000/0000-00" maxlength="18" />
                    </div>
                    <div class="form-group">
                        <label for="supplierContactName">Nome do Contato</label>
                        <input type="text" id="supplierContactName" placeholder="Ex: Jo√£o Silva" />
                    </div>
                    <div class="form-group">
                        <label for="supplierPhone">Telefone</label>
                        <input type="text" id="supplierPhone" placeholder="(00) 00000-0000" maxlength="15" />
                    </div>
                    <div class="form-group">
                        <label for="supplierEmail">E-mail</label>
                        <input type="email" id="supplierEmail" placeholder="fornecedor@email.com" />
                    </div>
                    <div class="form-group">
                        <label for="supplierAddress">Endere√ßo</label>
                        <textarea id="supplierAddress" rows="3" placeholder="Rua, n√∫mero, bairro, cidade - CEP"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="supplierRating">Avalia√ß√£o (1-5 estrelas)</label>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <input type="range" id="supplierRating" min="1" max="5" value="3" step="1" style="flex: 1;" />
                            <span id="supplierRatingDisplay" style="font-weight: 600; color: var(--primary-color); min-width: 60px;">3 ‚≠ê</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="supplierNotes">Observa√ß√µes</label>
                        <textarea id="supplierNotes" rows="2" placeholder="Informa√ß√µes adicionais sobre o fornecedor"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" onclick="app.closeSupplierModal()">
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Salvar Fornecedor
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Cadastro/Edi√ß√£o de Cupom -->
        <div id="couponModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="couponModalTitle">Novo Cupom</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="couponForm">
                    <div class="form-group">
                        <label for="couponCode">C√≥digo do Cupom *</label>
                        <input type="text" id="couponCode" required placeholder="Ex: DESCONTO10" maxlength="20" style="text-transform: uppercase;" />
                        <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                            C√≥digo √∫nico que ser√° usado para aplicar o desconto
                        </small>
                    </div>
                    <div class="form-group">
                        <label for="couponType">Tipo de Desconto *</label>
                        <select id="couponType" required>
                            <option value="">Selecione o tipo</option>
                            <option value="percent">Percentual (%)</option>
                            <option value="fixed">Valor Fixo (R$)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="couponValue">Valor do Desconto *</label>
                        <input type="number" id="couponValue" step="0.01" min="0.01" required placeholder="Ex: 10 ou 50.00" />
                        <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                            Se percentual: valor entre 0 e 100. Se fixo: valor em reais.
                        </small>
                    </div>
                    <div class="form-group">
                        <label for="couponDescription">Descri√ß√£o</label>
                        <textarea id="couponDescription" rows="2" placeholder="Descri√ß√£o do cupom (opcional)"></textarea>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label for="couponStartsAt">Data de In√≠cio</label>
                            <input type="date" id="couponStartsAt" />
                            <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                                Data em que a promo√ß√£o come√ßa a valer
                            </small>
                        </div>
                        <div class="form-group">
                            <label for="couponExpiresAt">Data de Expira√ß√£o</label>
                            <input type="date" id="couponExpiresAt" />
                            <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                                Data em que a promo√ß√£o expira
                            </small>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label for="couponMaxUses">Limite de Uso</label>
                            <input type="number" id="couponMaxUses" min="1" placeholder="Ilimitado se vazio" />
                        </div>
                        <div class="form-group">
                            <label for="couponMinQuantity">Quantidade M√≠nima (Desconto por Quantidade)</label>
                            <input type="number" id="couponMinQuantity" min="1" placeholder="Ex: 5 unidades" />
                            <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                                Desconto aplicado apenas se comprar esta quantidade m√≠nima
                            </small>
                        </div>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="couponActive" checked />
                            <span>Cupom ativo</span>
                        </label>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" onclick="app.closeCouponModal()">
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Salvar Cupom
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Registrar Venda -->
        <div id="saleModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Registrar Venda</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="saleForm">
                    <div class="form-group" id="saleDayInfo" style="background: var(--light-gray); padding: 10px; border-radius: 5px; margin-bottom: 15px; text-align: center;">
                        <strong>Dia: <span id="saleDayDisplay">-</span></strong>
                    </div>
                    <div class="form-group">
                        <label for="saleCustomerName">Nome do Cliente *</label>
                        <div style="display: flex; gap: 0.5rem; align-items: flex-start;">
                            <select id="saleCustomerSelect" style="flex: 1;" onchange="app.onClientSelectChange('sale')">
                                <option value="">Selecione um cliente ou digite novo nome...</option>
                            </select>
                            <button type="button" class="btn-secondary" onclick="app.openClientModal()" title="Novo Cliente" style="white-space: nowrap;">
                                <i class="fas fa-user-plus"></i>
                            </button>
                        </div>
                        <input
                            type="text"
                            id="saleCustomerName"
                            placeholder="Ou digite o nome do cliente"
                            required
                            style="margin-top: 0.5rem;"
                        />
                    </div>
                    <div class="form-group">
                        <label for="saleCustomerCPF">CPF do Cliente</label>
                        <input
                            type="text"
                            id="saleCustomerCPF"
                            placeholder="000.000.000-00"
                            maxlength="14"
                        />
                    </div>
                    <div class="form-group">
                        <label for="saleItem">Item *</label>
                        <div style="display: flex; gap: 0.5rem; align-items: flex-start;">
                            <select id="saleItem" required style="flex: 1;">
                                <option value="">Selecione um item...</option>
                            </select>
                            <button type="button" class="btn-secondary" id="scanQRBtn" title="Escanear QR Code" aria-label="Escanear QR Code do produto" style="white-space: nowrap;">
                                <i class="fas fa-qrcode"></i>
                            </button>
                        </div>
                        <div id="qrScannerContainer" style="display: none; margin-top: 1rem; padding: 1rem; background: var(--light-gray); border-radius: 5px;">
                            <div id="qrReader" style="width: 100%; max-width: 400px; margin: 0 auto;"></div>
                            <button type="button" class="btn-secondary" id="stopScanBtn" style="margin-top: 1rem; width: 100%;">
                                <i class="fas fa-stop"></i> Parar Escaneamento
                            </button>
                        </div>
                        <!-- Info do servi√ßo (s√≥ aparece para servi√ßos) -->
                        <div id="serviceInfo" style="display: none; margin-top: 0.75rem; padding: 0.75rem; background: #e7f3ff; border-radius: 5px; border-left: 3px solid #28a745;">
                            <small id="serviceDescriptionText" style="color: #155724; display: block;"></small>
                        </div>
                    </div>
                    <!-- Campo de tamanho (para roupas e eletr√¥nicos) -->
                    <div class="form-group" id="saleSizeGroup" style="display: none;">
                        <label for="saleSize">Tamanho *</label>
                        <input
                            type="text"
                            id="saleSize"
                            placeholder="Ex: P, M, G, 42, 128GB, etc."
                            required
                        />
                        <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                            O estoque √© controlado separadamente para cada tamanho
                        </small>
                    </div>
                    <!-- Campo de cor (opcional para roupas e eletr√¥nicos) -->
                    <div class="form-group" id="saleColorGroup" style="display: none;">
                        <label for="saleColor">Cor (opcional)</label>
                        <input
                            type="text"
                            id="saleColor"
                            placeholder="Ex: Preto, Branco, Azul, etc."
                        />
                        <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                            O estoque tamb√©m √© diferenciado por cor quando informada
                        </small>
                    </div>
                    <div class="form-group">
                        <label for="saleQuantity" id="saleQuantityLabel">Quantidade *</label>
                        <input
                            type="number"
                            id="saleQuantity"
                            min="1"
                            required
                        />
                    </div>
                    <div class="form-group">
                        <label for="salePrice">Pre√ßo Unit√°rio *</label>
                        <input
                            type="number"
                            id="salePrice"
                            step="0.01"
                            min="0.01"
                            required
                        />
                    </div>
                    
                    <!-- Sistema de Descontos -->
                    <div class="form-group" style="background: var(--gray-50); padding: 1rem; border-radius: var(--radius-md); border: 1px solid var(--gray-200);">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.75rem;">
                            <label for="saleDiscountType" style="margin: 0; font-weight: 600; color: var(--primary-color);">
                                <i class="fas fa-tag"></i> Desconto
                            </label>
                            <button type="button" class="btn-secondary" id="toggleDiscountBtn" onclick="app.toggleDiscountFields()" style="padding: 0.375rem 0.75rem; font-size: 0.875rem;">
                                <i class="fas fa-plus"></i> Aplicar Desconto
                            </button>
                        </div>
                        <div id="discountFields" style="display: none;">
                            <div style="display: flex; gap: 0.5rem; margin-bottom: 0.75rem;">
                                <select id="saleDiscountType" style="flex: 1;">
                                    <option value="">Tipo de desconto</option>
                                    <option value="percent">Percentual (%)</option>
                                    <option value="fixed">Valor fixo (R$)</option>
                                </select>
                                <input
                                    type="number"
                                    id="saleDiscountValue"
                                    step="0.01"
                                    min="0"
                                    placeholder="0.00"
                                    style="flex: 1;"
                                />
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="saleCouponCode" style="font-size: 0.875rem;">Cupom de Desconto (opcional)</label>
                                <div style="display: flex; gap: 0.5rem;">
                                    <input
                                        type="text"
                                        id="saleCouponCode"
                                        placeholder="Digite o c√≥digo do cupom"
                                        style="flex: 1;"
                                    />
                                    <button type="button" class="btn-secondary" onclick="app.applyCoupon()" style="white-space: nowrap;">
                                        <i class="fas fa-check"></i> Aplicar
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div id="discountSummary" style="display: none; margin-top: 0.75rem; padding: 0.75rem; background: var(--white); border-radius: var(--radius-sm); border: 1px solid var(--gray-200);">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <span style="color: var(--gray-600);">Subtotal:</span>
                                <span id="discountSubtotal" style="font-weight: 600;">R$ 0,00</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; color: var(--primary-color);">
                                <span>Desconto:</span>
                                <span id="discountAmount" style="font-weight: 600;">- R$ 0,00</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding-top: 0.5rem; border-top: 2px solid var(--gray-200); font-size: 1.1rem; font-weight: 700; color: var(--primary-color);">
                                <span>Total:</span>
                                <span id="discountTotal">R$ 0,00</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="saleNotes">Notas/Observa√ß√µes (opcional)</label>
                        <textarea id="saleNotes" rows="3" placeholder="Adicione observa√ß√µes sobre esta venda..." maxlength="500"></textarea>
                        <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                            Informa√ß√µes adicionais sobre a venda (m√°ximo 500 caracteres)
                        </small>
                    </div>
                    
                    <div class="modal-actions">
                        <button
                            type="button"
                            class="btn-secondary"
                            id="cancelSaleBtn"
                        >
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            Registrar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Preview de Recibo -->
        <div id="receiptPreviewModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2>Recibo de Venda</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <div class="receipt-content" id="receiptContent">
                    <!-- Conte√∫do do recibo ser√° inserido via JavaScript -->
                </div>
                <div class="modal-actions" style="margin-top: 1.5rem;">
                    <button type="button" class="btn-secondary" id="closeReceiptBtn">
                        Fechar
                    </button>
                    <button type="button" class="btn-primary" id="printReceiptBtn">
                        <i class="fas fa-print"></i> Imprimir
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: Busca de Comprovantes -->
        <div id="receiptSearchModal" class="modal">
            <div class="modal-content large" style="max-width: 900px;">
                <div class="modal-header">
                    <h2><i class="fas fa-search"></i> Buscar Comprovantes</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="app.closeReceiptSearchModal()">&times;</span>
                </div>
                <div class="receipt-search-content" style="padding: 1.5rem;">
                    <!-- Campo de busca -->
                    <div class="receipt-search-form" style="margin-bottom: 2rem;">
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <div style="flex: 1; min-width: 200px;">
                                <label for="receiptSearchName" style="display: block; margin-bottom: 0.5rem; color: var(--dark-gray); font-weight: 600;">
                                    <i class="fas fa-user"></i> Nome do Cliente
                                </label>
                                <input 
                                    type="text" 
                                    id="receiptSearchName" 
                                    placeholder="Digite o nome do cliente..."
                                    style="width: 100%; padding: 0.875rem 1.125rem; border-radius: var(--radius-md); border: 1px solid var(--gray-300); font-size: 0.95rem; transition: all var(--transition-base);"
                                    onkeyup="app.searchReceipts()"
                                />
                            </div>
                            <div style="flex: 1; min-width: 200px;">
                                <label for="receiptSearchCPF" style="display: block; margin-bottom: 0.5rem; color: var(--dark-gray); font-weight: 600;">
                                    <i class="fas fa-id-card"></i> CPF (opcional)
                                </label>
                                <input 
                                    type="text" 
                                    id="receiptSearchCPF" 
                                    placeholder="Digite o CPF..."
                                    style="width: 100%; padding: 0.875rem 1.125rem; border-radius: var(--radius-md); border: 1px solid var(--gray-300); font-size: 0.95rem; transition: all var(--transition-base);"
                                    onkeyup="app.searchReceipts()"
                                    oninput="app.formatCPFInput(this)"
                                />
                            </div>
                        </div>
                    </div>

                    <!-- Lista de resultados -->
                    <div class="receipt-results-container">
                        <h3 style="margin: 0 0 1rem 0; color: var(--dark-gray); font-size: 1.1rem;">
                            <i class="fas fa-list"></i> Resultados da Busca
                        </h3>
                        <div id="receiptResultsList" class="receipt-results-list" style="max-height: 400px; overflow-y: auto;">
                            <!-- Resultados ser√£o inseridos aqui via JavaScript -->
                        </div>
                    </div>
                </div>
                <div class="modal-actions" style="margin-top: 1.5rem; padding: 0 1.5rem 1.5rem;">
                    <button type="button" class="btn-secondary" onclick="app.closeReceiptSearchModal()">
                        <i class="fas fa-times"></i> Fechar
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: Pedido Pendente -->
        <div id="pendingOrderModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="pendingOrderModalTitle">Novo Pedido Pendente</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="pendingOrderForm">
                    <div class="form-group">
                        <label for="pendingOrderCustomerName">Nome do Cliente *</label>
                        <input
                            type="text"
                            id="pendingOrderCustomerName"
                            placeholder="Digite o nome do cliente"
                            required
                        />
                    </div>
                    <div class="form-group">
                        <label for="pendingOrderCustomerCPF">CPF do Cliente</label>
                        <input
                            type="text"
                            id="pendingOrderCustomerCPF"
                            placeholder="000.000.000-00"
                            maxlength="14"
                        />
                    </div>
                    <div class="form-group">
                        <label for="pendingOrderItems">Itens *</label>
                        <div id="pendingOrderItemsList" style="display: flex; flex-direction: column; gap: 0.75rem;">
                            <!-- Itens ser√£o adicionados dinamicamente -->
                        </div>
                        <button type="button" class="btn-secondary" id="addPendingOrderItemBtn" style="margin-top: 0.5rem;">
                            <i class="fas fa-plus"></i> Adicionar Item
                        </button>
                    </div>
                    <div class="form-group">
                        <label for="pendingOrderTotal">Valor Total (R$)</label>
                        <input
                            type="number"
                            id="pendingOrderTotal"
                            step="0.01"
                            min="0.01"
                            readonly
                            style="background: var(--light-gray)"
                        />
                    </div>
                    <div class="form-group">
                        <label for="pendingOrderStatus">Status *</label>
                        <select id="pendingOrderStatus" required>
                            <option value="pending">Pendente</option>
                            <option value="confirmed">Confirmado</option>
                            <option value="cancelled">Cancelado</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="pendingOrderDueDate">Data de Vencimento</label>
                        <input type="date" id="pendingOrderDueDate" />
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" id="cancelPendingOrderBtn">
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            Salvar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Agendamento de Servi√ßo -->
        <div id="serviceAppointmentModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="serviceAppointmentModalTitle">Novo Agendamento</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="serviceAppointmentForm">
                    <div class="form-group">
                        <label for="appointmentServiceType">Tipo de Servi√ßo *</label>
                        <select id="appointmentServiceType" required>
                            <option value="">Selecione um servi√ßo...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="appointmentCustomerName">Nome do Cliente *</label>
                        <input
                            type="text"
                            id="appointmentCustomerName"
                            placeholder="Digite o nome do cliente"
                            required
                        />
                    </div>
                    <div class="form-group">
                        <label for="appointmentCustomerContact">Contato do Cliente</label>
                        <input
                            type="text"
                            id="appointmentCustomerContact"
                            placeholder="Telefone ou e-mail"
                        />
                    </div>
                    <div class="form-group">
                        <label for="appointmentDate">Data *</label>
                        <input type="date" id="appointmentDate" required />
                    </div>
                    <div class="form-group">
                        <label for="appointmentTime">Hor√°rio *</label>
                        <input type="time" id="appointmentTime" required />
                    </div>
                    <div class="form-group">
                        <label for="appointmentPrice">Pre√ßo (R$) *</label>
                        <input
                            type="number"
                            id="appointmentPrice"
                            step="0.01"
                            min="0.01"
                            required
                        />
                    </div>
                    <div class="form-group">
                        <label for="appointmentStatus">Status *</label>
                        <select id="appointmentStatus" required>
                            <option value="pending">Pendente</option>
                            <option value="confirmed">Confirmado</option>
                            <option value="completed">Conclu√≠do</option>
                            <option value="cancelled">Cancelado</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="appointmentNotes">Observa√ß√µes</label>
                        <textarea
                            id="appointmentNotes"
                            rows="3"
                            placeholder="Observa√ß√µes sobre o agendamento..."
                        ></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" id="cancelServiceAppointmentBtn">
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            Salvar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Calend√°rio Completo de Agendamentos -->
        <div id="calendarModal" class="modal">
            <div class="modal-content calendar-modal-content">
                <div class="modal-header calendar-header">
                    <h2><i class="fas fa-calendar-check"></i> Calend√°rio de Agendamentos</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <div class="calendar-container">
                    <div class="calendar-nav">
                        <button class="calendar-nav-btn" id="prevMonthBtn" aria-label="M√™s anterior">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <h3 id="calendarMonthYear" class="calendar-month-year"></h3>
                        <button class="calendar-nav-btn" id="nextMonthBtn" aria-label="Pr√≥ximo m√™s">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calend√°rio ser√° renderizado aqui -->
                    </div>
                    <div class="calendar-legend">
                        <div class="legend-item">
                            <span class="legend-dot dot-has-appointment"></span>
                            <span>Dia com agendamento</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-dot dot-today"></span>
                            <span>Hoje</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: Criar Grupo Mensal -->
        <div id="groupModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Novo Grupo Mensal</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="groupForm">
                    <div class="form-group">
                        <label for="groupMonth">M√™s/Ano *</label>
                        <input type="month" id="groupMonth" required />
                    </div>
                    <div class="modal-actions">
                        <button
                            type="button"
                            class="btn-secondary"
                            id="cancelGroupBtn"
                        >
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            Criar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Visualizar/Editar Grupo -->
        <div id="viewGroupModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2 id="groupTitle">Grupo Mensal</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <div class="group-content">
                    <div class="group-summary">
                        <div class="summary-card">
                            <h3>Total de Vendas (M√™s)</h3>
                            <p id="totalSales">0</p>
                        </div>
                        <div class="summary-card">
                            <h3>Valor Total (M√™s)</h3>
                            <p id="totalValue">R$ 0,00</p>
                        </div>
                        <div class="summary-card summary-card-highlight">
                            <h3>Total de Vendas (Todos os Meses)</h3>
                            <p id="totalSalesAll">0</p>
                        </div>
                        <div class="summary-card summary-card-highlight">
                            <h3>Valor Total (Todos os Meses)</h3>
                            <p id="totalValueAll">R$ 0,00</p>
                        </div>
                    </div>
                    <div class="stock-summary-card" style="margin: 1.5rem 0; padding: 1.5rem; background: #f8f9fa; border-radius: 8px; border: 2px solid #17a2b8;">
                        <h3 style="margin-bottom: 1rem; color: #0c5460;">üì¶ Resumo de Estoque do M√™s</h3>
                        <div class="summary-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <div class="stat-item" style="background: #e7f3ff; border: 2px solid #17a2b8; padding: 1rem; border-radius: 8px;">
                                <h4 style="margin: 0 0 0.5rem 0; color: #0c5460; font-size: 0.9rem;">Estoque Total</h4>
                                <p id="groupStockTotal" style="margin: 0; color: #0c5460; font-size: 1.5rem; font-weight: bold;">0 un.</p>
                            </div>
                            <div class="stat-item" style="background: #fff3cd; border: 2px solid #ffc107; padding: 1rem; border-radius: 8px;">
                                <h4 style="margin: 0 0 0.5rem 0; color: #856404; font-size: 0.9rem;">Estoque Vendido</h4>
                                <p id="groupStockSold" style="margin: 0; color: #856404; font-size: 1.5rem; font-weight: bold;">0 un.</p>
                            </div>
                            <div class="stat-item" style="background: #d4edda; border: 2px solid #28a745; padding: 1rem; border-radius: 8px;">
                                <h4 style="margin: 0 0 0.5rem 0; color: #155724; font-size: 0.9rem;">Estoque Dispon√≠vel</h4>
                                <p id="groupStockAvailable" style="margin: 0; color: #155724; font-size: 1.5rem; font-weight: bold;">0 un.</p>
                            </div>
                            <div class="stat-item" id="groupLowStockAlert" style="display: none; background: #f8d7da; border: 2px solid #dc3545; padding: 1rem; border-radius: 8px;">
                                <h4 style="margin: 0 0 0.5rem 0; color: #721c24; font-size: 0.9rem;">‚ö†Ô∏è Alerta: Estoque Baixo</h4>
                                <p id="groupLowStockItems" style="margin: 0; color: #721c24; font-size: 1rem;">-</p>
                            </div>
                        </div>
                    </div>
                    <div class="days-container">
                        <div>
                            <h3>Vendas por Dia</h3>
                            <button type="button" class="btn-primary" id="manageStockBtn" style="margin-top: 1rem; padding: 0.5rem 1rem; font-size: 0.9rem;">
                                <i class="fas fa-warehouse"></i> Gerenciar Estoque do M√™s
                            </button>
                        </div>
                        <div id="daysList" class="days-list">
                            <!-- Dias ser√£o inseridos aqui -->
                        </div>
                    </div>
                    <div class="items-summary">
                        <h3>Resumo por Item</h3>
                        <div id="itemsSummary" class="items-summary-list">
                            <!-- Resumo ser√° inserido aqui -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: Cadastrar Custo de Compra -->
        <div id="costModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="costModalTitle">Cadastrar Novo Custo</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="costForm">
                    <div class="form-group">
                        <label for="costItem">Item *</label>
                        <select id="costItem" required>
                            <option value="">Selecione um item...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="costSupplier">Fornecedor (opcional)</label>
                        <div style="display: flex; gap: 0.5rem; align-items: flex-start;">
                            <select id="costSupplier" style="flex: 1;">
                                <option value="">Selecione um fornecedor ou deixe em branco...</option>
                            </select>
                            <button type="button" class="btn-secondary" onclick="app.openSupplierModal()" title="Novo Fornecedor" style="white-space: nowrap;">
                                <i class="fas fa-truck"></i>
                            </button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="costDate">Data da Compra *</label>
                        <input type="date" id="costDate" required />
                    </div>
                    <div class="form-group">
                        <label for="costQuantity">Quantidade *</label>
                        <input
                            type="number"
                            id="costQuantity"
                            min="1"
                            required
                        />
                    </div>
                    <div class="form-group">
                        <label for="costPrice">Custo Unit√°rio *</label>
                        <input
                            type="number"
                            id="costPrice"
                            step="0.01"
                            min="0.01"
                            required
                        />
                    </div>
                    <div class="form-group">
                        <label for="costTotal">Custo Total</label>
                        <input
                            type="number"
                            id="costTotal"
                            step="0.01"
                            readonly
                            style="background: var(--light-gray)"
                        />
                    </div>
                    <div class="modal-actions">
                        <button
                            type="button"
                            class="btn-secondary"
                            id="cancelCostBtn"
                        >
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            Salvar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Gerenciar Estoque do M√™s -->
        <div id="stockModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2 id="stockModalTitle">Gerenciar Estoque do M√™s</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <div class="stock-content">
                    <div class="form-group">
                        <label for="stockDay">Dia *</label>
                        <input type="number" id="stockDay" min="1" max="31" required />
                    </div>
                    <div class="stock-items-list" id="stockItemsList" style="max-height: 400px; overflow-y: auto; margin-top: 1rem;">
                        <!-- Itens com estoque ser√£o inseridos aqui -->
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancelStockBtn">
                        Cancelar
                    </button>
                    <button type="button" class="btn-primary" id="saveStockBtn">
                        Salvar Estoque
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal: Criar M√™s de Servi√ßos -->
        <div id="serviceGroupModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Novo M√™s de Servi√ßos</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="serviceGroupForm">
                    <div class="form-group">
                        <label for="serviceGroupMonth">M√™s/Ano *</label>
                        <input type="month" id="serviceGroupMonth" required />
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" id="cancelServiceGroupBtn">
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">Criar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Registrar Servi√ßo no M√™s -->
        <div id="serviceRecordModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Registrar Servi√ßo</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="serviceRecordForm">
                    <div class="form-group" id="serviceRecordDayInfo" style="background: var(--light-gray); padding: 0.75rem; border-radius: 5px; margin-bottom: 1rem; text-align: center;">
                        <strong>Dia: <span id="serviceRecordDayDisplay">-</span></strong>
                    </div>
                    <div class="form-group">
                        <label for="serviceRecordItem">Servi√ßo *</label>
                        <select id="serviceRecordItem" required>
                            <option value="">Selecione um servi√ßo...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="serviceRecordHours">Horas Trabalhadas *</label>
                        <div style="display: flex; gap: 0.5rem; align-items: center; justify-content: center;">
                            <input
                                type="number"
                                id="serviceRecordHours"
                                min="0"
                                placeholder="Horas"
                                required
                                style="flex: 1; max-width: 120px;"
                            />
                            <span style="font-weight: bold;">:</span>
                            <input
                                type="number"
                                id="serviceRecordMinutes"
                                min="0"
                                max="59"
                                placeholder="Minutos"
                                required
                                style="flex: 1; max-width: 120px;"
                            />
                        </div>
                        <small style="color: var(--gray); display: block; margin-top: 0.25rem; text-align: center;">
                            Use as horas padr√£o do servi√ßo ou informe manualmente
                        </small>
                    </div>
                    <div class="form-group">
                        <label for="serviceRecordPrice">Pre√ßo Aplicado (R$) *</label>
                        <input
                            type="number"
                            id="serviceRecordPrice"
                            step="0.01"
                            min="0.01"
                            required
                        />
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" id="cancelServiceRecordBtn">
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            Registrar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Visualizar Servi√ßos do M√™s -->
        <div id="viewServiceGroupModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2 id="serviceGroupTitle">Servi√ßos do M√™s</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <div class="service-group-content">
                    <div class="service-group-summary">
                        <div class="summary-card">
                            <h3>Total de Horas (M√™s)</h3>
                            <p id="serviceGroupTotalHours">0h 0min</p>
                        </div>
                        <div class="summary-card">
                            <h3>Total Faturado (M√™s)</h3>
                            <p id="serviceGroupTotalRevenue">R$ 0,00</p>
                        </div>
                        <div class="summary-card" style="background: #fff3cd; border: 2px solid #ffc107;">
                            <h3>Total de Horas (Todos os Meses)</h3>
                            <p id="serviceGroupTotalHoursAll" style="color: #856404; font-size: 1.8rem; font-weight: bold;">0h 0min</p>
                        </div>
                        <div class="summary-card" style="background: #d4edda; border: 2px solid #28a745;">
                            <h3>Total Faturado (Todos os Meses)</h3>
                            <p id="serviceGroupTotalRevenueAll" style="color: #155724; font-size: 1.8rem; font-weight: bold;">R$ 0,00</p>
                        </div>
                    </div>
                    <div class="service-days-container">
                        <h3>Servi√ßos por Dia</h3>
                        <div id="serviceDaysList" class="service-days-list">
                            <!-- Servi√ßos por dia ser√£o inseridos aqui -->
                        </div>
                    </div>
                    <div class="service-items-summary">
                        <h3>Resumo por Servi√ßo</h3>
                        <div id="serviceItemsSummary" class="service-items-summary-list">
                            <!-- Resumo ser√° inserido aqui -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: Criar/Editar Meta -->
        <div id="goalModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="goalModalTitle">Criar Nova Meta</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <form id="goalForm">
                    <div class="form-group">
                        <label for="goalMonth">M√™s/Ano *</label>
                        <input type="month" id="goalMonth" required />
                    </div>
                    <div class="form-group">
                        <label for="goalAmount">Valor da Meta (R$) *</label>
                        <input
                            type="number"
                            id="goalAmount"
                            step="0.01"
                            min="0.01"
                            required
                        />
                    </div>
                    <div class="form-group">
                        <label for="goalDescription">Descri√ß√£o (opcional)</label>
                        <input type="text" id="goalDescription" placeholder="Ex: Meta de vendas de ver√£o" />
                    </div>
                    <div class="modal-actions">
                        <button
                            type="button"
                            class="btn-secondary"
                            id="cancelGoalBtn"
                        >
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            Salvar
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Construtor de Relat√≥rios -->
        <div id="reportBuilderModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2><i class="fas fa-file-alt"></i> Gerar Relat√≥rio Personalizado</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="app.closeReportBuilderModal()">&times;</span>
                </div>
                <div style="padding: 1.5rem;">
                    <form id="reportBuilderForm">
                        <div class="form-group">
                            <label for="reportBuilderType">Tipo de Relat√≥rio *</label>
                            <select id="reportBuilderType" required onchange="app.updateReportBuilderFields()">
                                <option value="">Selecione o tipo...</option>
                                <option value="sales">Vendas</option>
                                <option value="services">Servi√ßos</option>
                                <option value="products">Produtos</option>
                                <option value="clients">Clientes</option>
                                <option value="financial">Financeiro</option>
                                <option value="custom">Personalizado</option>
                            </select>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1.5rem 0;">
                            <div class="form-group">
                                <label for="reportBuilderStartDate">Data Inicial</label>
                                <input type="date" id="reportBuilderStartDate" />
                            </div>
                            <div class="form-group">
                                <label for="reportBuilderEndDate">Data Final</label>
                                <input type="date" id="reportBuilderEndDate" />
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="reportBuilderPeriod">Ou selecione um per√≠odo pr√©-definido</label>
                            <select id="reportBuilderPeriod" onchange="app.setReportBuilderPeriod()">
                                <option value="">Personalizado</option>
                                <option value="today">Hoje</option>
                                <option value="week">Esta Semana</option>
                                <option value="month">Este M√™s</option>
                                <option value="quarter">Este Trimestre</option>
                                <option value="year">Este Ano</option>
                                <option value="lastMonth">M√™s Anterior</option>
                                <option value="lastQuarter">Trimestre Anterior</option>
                                <option value="lastYear">Ano Anterior</option>
                            </select>
                        </div>
                        
                        <div id="reportBuilderFilters" style="margin: 1.5rem 0;">
                            <h3 style="margin: 0 0 1rem 0; color: var(--dark-gray); font-size: 1rem;">
                                <i class="fas fa-filter"></i> Filtros Adicionais
                            </h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                <div class="form-group">
                                    <label for="reportBuilderCategory">Categoria (Produtos)</label>
                                    <select id="reportBuilderCategory">
                                        <option value="">Todas</option>
                                        <option value="Roupas">Roupas</option>
                                        <option value="Eletr√¥nicos">Eletr√¥nicos</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="reportBuilderStatus">Status (Vendas/Agendamentos)</label>
                                    <select id="reportBuilderStatus">
                                        <option value="">Todos</option>
                                        <option value="completed">Conclu√≠do</option>
                                        <option value="pending">Pendente</option>
                                        <option value="cancelled">Cancelado</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="reportBuilderFormat">Formato de Exporta√ß√£o *</label>
                            <select id="reportBuilderFormat" required>
                                <option value="html">HTML (Visualiza√ß√£o)</option>
                                <option value="json">JSON</option>
                                <option value="csv">CSV</option>
                                <option value="txt">TXT</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="reportBuilderIncludeCharts" />
                                <span>Incluir gr√°ficos no relat√≥rio</span>
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="reportBuilderIncludeSummary" checked />
                                <span>Incluir resumo executivo</span>
                            </label>
                        </div>
                        
                        <div style="display: flex; gap: 0.5rem; margin-top: 1.5rem;">
                            <button type="button" class="btn-secondary" onclick="app.closeReportBuilderModal()">
                                Cancelar
                            </button>
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-file-download"></i> Gerar Relat√≥rio
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Modal: Exporta√ß√£o Avan√ßada -->
        <div id="exportModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-download"></i> Exportar Dados</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="app.closeExportModal()">&times;</span>
                </div>
                <div style="padding: 1.5rem;">
                    <form id="exportForm">
                        <div class="form-group">
                            <label for="exportFormat">Formato de Exporta√ß√£o *</label>
                            <select id="exportFormat" required>
                                <option value="json">JSON (Backup Completo)</option>
                                <option value="pdf">PDF (Relat√≥rio Formatado)</option>
                                <option value="excel">Excel (Planilha)</option>
                                <option value="csv">CSV (Dados Simples)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="exportDataType">Dados para Exportar *</label>
                            <select id="exportDataType" required>
                                <option value="all">Todos os Dados</option>
                                <option value="items">Apenas Produtos</option>
                                <option value="sales">Apenas Vendas</option>
                                <option value="clients">Apenas Clientes</option>
                                <option value="financial">Dados Financeiros (Vendas + Custos)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="exportIncludeCharts" />
                                <span>Incluir gr√°ficos (apenas PDF)</span>
                            </label>
                        </div>
                        
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="exportIncludeSummary" checked />
                                <span>Incluir resumo executivo</span>
                            </label>
                        </div>
                        
                        <div style="display: flex; gap: 0.5rem; margin-top: 1.5rem;">
                            <button type="button" class="btn-secondary" onclick="app.closeExportModal()">
                                Cancelar
                            </button>
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-file-download"></i> Exportar
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Modal: An√°lise Preditiva -->
        <div id="predictiveAnalysisModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2><i class="fas fa-chart-line"></i> An√°lise Preditiva</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="app.closePredictiveAnalysisModal()">&times;</span>
                </div>
                <div style="padding: 1.5rem;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                        <div style="padding: 1rem; background: var(--light-gray); border-radius: var(--radius-sm);">
                            <h3 style="margin: 0 0 0.5rem 0; font-size: 0.9rem; color: var(--gray-600);">Previs√£o de Vendas (Pr√≥ximo M√™s)</h3>
                            <p id="salesForecast" style="margin: 0; font-size: 1.5rem; font-weight: 700; color: var(--primary-color);">R$ 0,00</p>
                        </div>
                        <div style="padding: 1rem; background: var(--light-gray); border-radius: var(--radius-sm);">
                            <h3 style="margin: 0 0 0.5rem 0; font-size: 0.9rem; color: var(--gray-600);">Tend√™ncia</h3>
                            <p id="salesTrend" style="margin: 0; font-size: 1.2rem; font-weight: 600;">-</p>
                        </div>
                        <div style="padding: 1rem; background: var(--light-gray); border-radius: var(--radius-sm);">
                            <h3 style="margin: 0 0 0.5rem 0; font-size: 0.9rem; color: var(--gray-600);">Crescimento Esperado</h3>
                            <p id="expectedGrowth" style="margin: 0; font-size: 1.2rem; font-weight: 600;">-</p>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 1.5rem;">
                        <label for="predictivePeriod">Per√≠odo para An√°lise</label>
                        <select id="predictivePeriod" onchange="app.updatePredictiveAnalysis()">
                            <option value="3">√öltimos 3 meses</option>
                            <option value="6" selected>√öltimos 6 meses</option>
                            <option value="12">√öltimos 12 meses</option>
                        </select>
                    </div>
                    
                    <div id="predictiveInsights" style="margin-bottom: 1.5rem;">
                        <!-- Insights ser√£o inseridos aqui -->
                    </div>
                    
                    <div id="predictiveRecommendations" style="margin-bottom: 1.5rem;">
                        <h3 style="margin: 0 0 1rem 0; color: var(--dark-gray); font-size: 1rem;">
                            <i class="fas fa-lightbulb"></i> Recomenda√ß√µes
                        </h3>
                        <div id="recommendationsList">
                            <!-- Recomenda√ß√µes ser√£o inseridas aqui -->
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 0.5rem; margin-top: 1.5rem;">
                        <button type="button" class="btn-secondary" onclick="app.closePredictiveAnalysisModal()">
                            Fechar
                        </button>
                        <button type="button" class="btn-primary" onclick="app.exportPredictiveAnalysis()">
                            <i class="fas fa-download"></i> Exportar An√°lise
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: An√°lise de Concorr√™ncia -->
        <div id="competitiveAnalysisModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2><i class="fas fa-chart-bar"></i> An√°lise de Concorr√™ncia</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="app.closeCompetitiveAnalysisModal()">&times;</span>
                </div>
                <div style="padding: 1.5rem;">
                    <div class="form-group" style="margin-bottom: 1.5rem;">
                        <label for="competitivePeriod">Per√≠odo de An√°lise:</label>
                        <select id="competitivePeriod" onchange="app.updateCompetitiveAnalysis()">
                            <option value="3">√öltimos 3 meses</option>
                            <option value="6" selected>√öltimos 6 meses</option>
                            <option value="12">√öltimos 12 meses</option>
                        </select>
                    </div>
                    
                    <div id="competitiveAnalysisContainer">
                        <!-- An√°lise ser√° renderizada aqui -->
                    </div>
                    
                    <div style="display: flex; gap: 0.5rem; margin-top: 1.5rem;">
                        <button type="button" class="btn-secondary" onclick="app.closeCompetitiveAnalysisModal()">
                            Fechar
                        </button>
                        <button type="button" class="btn-primary" onclick="app.exportCompetitiveAnalysis()">
                            <i class="fas fa-download"></i> Exportar An√°lise
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: Hist√≥rico de Promo√ß√µes -->
        <div id="promotionHistoryModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2><i class="fas fa-history"></i> Hist√≥rico de Promo√ß√µes</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="app.closePromotionHistoryModal()">&times;</span>
                </div>
                <div style="padding: 1.5rem;">
                    <div class="form-group" style="margin-bottom: 1.5rem;">
                        <label for="promotionHistoryFilter">Filtrar por Cupom</label>
                        <select id="promotionHistoryFilter" onchange="app.renderPromotionHistory()" style="width: 100%;">
                            <option value="">Todos os cupons</option>
                        </select>
                    </div>
                    <div id="promotionHistoryList" style="max-height: 600px; overflow-y: auto;">
                        <!-- Hist√≥rico ser√° inserido aqui via JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: Busca Avan√ßada -->
        <div id="advancedSearchModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2><i class="fas fa-search"></i> Busca Avan√ßada</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="app.closeAdvancedSearchModal()">&times;</span>
                </div>
                <div style="padding: 1.5rem;">
                    <div class="form-group">
                        <label for="advancedSearchTerm">Termo de Busca</label>
                        <input 
                            type="text" 
                            id="advancedSearchTerm" 
                            class="search-input-with-icon" 
                            placeholder="Digite o termo para buscar..."
                            onkeyup="if(event.key==='Enter') app.executeAdvancedSearch()"
                            style="width: 100%;"
                        />
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1.5rem 0;">
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="searchInProducts" checked />
                                <span><i class="fas fa-box"></i> Produtos</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="searchInClients" checked />
                                <span><i class="fas fa-user"></i> Clientes</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="searchInSuppliers" />
                                <span><i class="fas fa-truck"></i> Fornecedores</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="searchInSales" />
                                <span><i class="fas fa-shopping-cart"></i> Vendas</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="searchInAppointments" />
                                <span><i class="fas fa-calendar-check"></i> Agendamentos</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="searchInNotes" />
                                <span><i class="fas fa-sticky-note"></i> Notas</span>
                            </label>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1.5rem 0;">
                        <div class="form-group">
                            <label for="advancedSearchCategory">Categoria (Produtos)</label>
                            <select id="advancedSearchCategory">
                                <option value="">Todas as categorias</option>
                                <option value="Roupas">Roupas</option>
                                <option value="Eletr√¥nicos">Eletr√¥nicos</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="advancedSearchDateRange">Per√≠odo (Vendas/Agendamentos)</label>
                            <select id="advancedSearchDateRange">
                                <option value="">Todos os per√≠odos</option>
                                <option value="today">Hoje</option>
                                <option value="week">Esta Semana</option>
                                <option value="month">Este M√™s</option>
                                <option value="quarter">Este Trimestre</option>
                                <option value="year">Este Ano</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem;">
                        <button class="btn-primary" onclick="app.executeAdvancedSearch()" style="flex: 1;">
                            <i class="fas fa-search"></i> Buscar
                        </button>
                        <button class="btn-secondary" onclick="app.clearAdvancedSearch()">
                            <i class="fas fa-times"></i> Limpar
                        </button>
                    </div>
                    
                    <div id="advancedSearchResults" class="items-grid" style="max-height: 600px; overflow-y: auto;">
                        <p style="text-align: center; color: var(--gray-600); padding: 2rem;">Digite um termo e selecione onde buscar...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: Busca por Notas -->
        <div id="notesSearchModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2><i class="fas fa-sticky-note"></i> Buscar por Notas</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="app.closeNotesSearchModal()">&times;</span>
                </div>
                <div style="padding: 1.5rem;">
                    <div class="form-group">
                        <label for="notesSearchInput">Digite o termo para buscar nas notas</label>
                        <div style="display: flex; gap: 0.5rem;">
                            <input 
                                type="text" 
                                id="notesSearchInput" 
                                class="search-input-with-icon" 
                                placeholder="Buscar em produtos, clientes, fornecedores, vendas e agendamentos..."
                                onkeyup="if(event.key==='Enter') app.executeNotesSearch()"
                                oninput="app.executeNotesSearch()"
                                style="flex: 1;"
                            />
                            <button class="btn-primary" onclick="app.executeNotesSearch()">
                                <i class="fas fa-search"></i> Buscar
                            </button>
                        </div>
                    </div>
                    <div id="notesSearchResults" class="items-grid" style="margin-top: 1.5rem; max-height: 600px; overflow-y: auto;">
                        <p style="text-align: center; color: var(--gray-600); padding: 2rem;">Digite um termo para buscar nas notas...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: Visualizar QR Code -->
        <div id="qrcodeModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>QR Code do Produto</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0">&times;</span>
                </div>
                <div style="text-align: center; padding: 2rem;">
                    <canvas id="qrcodeModalCanvas" style="max-width: 100%; height: auto; border: 2px solid var(--border-color); padding: 1rem; background: white;"></canvas>
                    <p id="qrcodeItemName" style="margin-top: 1rem; font-weight: bold; font-size: 1.1rem;"></p>
                    <div style="margin-top: 1.5rem; display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;">
                        <button type="button" class="btn-primary" id="downloadQRModalBtn">
                            <i class="fas fa-download"></i> Baixar QR Code
                        </button>
                        <button type="button" class="btn-secondary" id="printQRModalBtn">
                            <i class="fas fa-print"></i> Imprimir
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal: Cadastro/Edi√ß√£o de Template -->
        <div id="templateModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="templateModalTitle">Novo Template</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="app.closeTemplateModal()">&times;</span>
                </div>
                <form id="templateForm" onsubmit="app.saveTemplate(event)">
                    <div class="form-group">
                        <label for="templateName">Nome do Template *</label>
                        <input type="text" id="templateName" required placeholder="Ex: Produto Padr√£o, Venda R√°pida" />
                    </div>
                    <div class="form-group">
                        <label for="templateType">Tipo de Template *</label>
                        <select id="templateType" required onchange="app.toggleTemplateFields(this.value)">
                            <option value="">Selecione o tipo...</option>
                            <option value="product">Produto</option>
                            <option value="sale">Venda</option>
                            <option value="service">Servi√ßo</option>
                            <option value="report">Relat√≥rio</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="templateDescription">Descri√ß√£o</label>
                        <textarea id="templateDescription" rows="2" placeholder="Descri√ß√£o do template (opcional)"></textarea>
                    </div>
                    
                    <!-- Campos espec√≠ficos para Produto -->
                    <div id="templateProductFields" style="display: none;">
                        <div class="form-group">
                            <label for="templateCategory">Categoria</label>
                            <input type="text" id="templateCategory" placeholder="Ex: Roupas, Eletr√¥nicos" />
                        </div>
                        <div class="form-group">
                            <label for="templatePrice">Pre√ßo Padr√£o (R$)</label>
                            <input type="number" id="templatePrice" step="0.01" min="0" placeholder="0.00" />
                        </div>
                    </div>
                    
                    <!-- Campos espec√≠ficos para Venda -->
                    <div id="templateSaleFields" style="display: none;">
                        <div class="form-group">
                            <label for="templateSaleQuantity">Quantidade Padr√£o</label>
                            <input type="number" id="templateSaleQuantity" min="1" value="1" />
                        </div>
                        <div class="form-group">
                            <label for="templateSaleDiscount">Desconto Padr√£o (%)</label>
                            <input type="number" id="templateSaleDiscount" step="0.1" min="0" max="100" value="0" />
                        </div>
                    </div>
                    
                    <!-- Campos espec√≠ficos para Servi√ßo -->
                    <div id="templateServiceFields" style="display: none;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label for="templateServiceHours">Horas</label>
                                <input type="number" id="templateServiceHours" min="0" value="0" />
                            </div>
                            <div class="form-group">
                                <label for="templateServiceMinutes">Minutos</label>
                                <input type="number" id="templateServiceMinutes" min="0" max="59" value="0" />
                            </div>
                        </div>
                    </div>
                    
                    <!-- Campos espec√≠ficos para Relat√≥rio -->
                    <div id="templateReportFields" style="display: none;">
                        <div class="form-group">
                            <label for="templateReportType">Tipo de Relat√≥rio *</label>
                            <select id="templateReportType">
                                <option value="">Selecione...</option>
                                <option value="sales">Vendas</option>
                                <option value="services">Servi√ßos</option>
                                <option value="products">Produtos</option>
                                <option value="clients">Clientes</option>
                                <option value="financial">Financeiro</option>
                                <option value="custom">Personalizado</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="templateReportPeriod">Per√≠odo Padr√£o</label>
                            <select id="templateReportPeriod">
                                <option value="today">Hoje</option>
                                <option value="week">Esta Semana</option>
                                <option value="month">Este M√™s</option>
                                <option value="quarter">Este Trimestre</option>
                                <option value="year">Este Ano</option>
                                <option value="custom">Personalizado</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="templateReportFormat">Formato de Exporta√ß√£o</label>
                            <select id="templateReportFormat">
                                <option value="pdf">PDF</option>
                                <option value="excel">Excel</option>
                                <option value="csv">CSV</option>
                                <option value="json">JSON</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="templateReportColumns">Colunas a Incluir (separadas por v√≠rgula)</label>
                            <input type="text" id="templateReportColumns" placeholder="Ex: data, cliente, produto, valor, quantidade" />
                            <small style="color: var(--gray-600); font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                                Deixe em branco para incluir todas as colunas padr√£o
                            </small>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="checkbox" id="templateReportIncludeCharts" />
                                <span>Incluir gr√°ficos no relat√≥rio</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button type="button" class="btn-secondary" onclick="app.closeTemplateModal()">
                            Cancelar
                        </button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> Salvar Template
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal: Configura√ß√µes de Acessibilidade -->
        <div id="accessibilityModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-universal-access"></i> Configura√ß√µes de Acessibilidade</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="app.closeAccessibilityModal()">&times;</span>
                </div>
                <div style="padding: 1.5rem;">
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="highContrastToggle" onchange="app.toggleHighContrast()" />
                            Modo Alto Contraste
                        </label>
                        <small style="display: block; color: var(--gray-600); margin-top: 0.25rem;">
                            Aumenta o contraste entre texto e fundo para melhor legibilidade
                        </small>
                    </div>

                    <div class="form-group" style="margin-top: 1.5rem;">
                        <label for="fontSizeSelect">Tamanho da Fonte</label>
                        <select id="fontSizeSelect" onchange="app.setFontSize(this.value)">
                            <option value="small">Pequeno</option>
                            <option value="normal" selected>Normal</option>
                            <option value="large">Grande</option>
                            <option value="extra-large">Extra Grande</option>
                        </select>
                    </div>

                    <div class="form-group" style="margin-top: 1.5rem;">
                        <label for="spacingSelect">Espa√ßamento</label>
                        <select id="spacingSelect" onchange="app.setSpacing(this.value)">
                            <option value="compact">Compacto</option>
                            <option value="normal" selected>Normal</option>
                            <option value="comfortable">Confort√°vel</option>
                        </select>
                    </div>

                    <div class="modal-actions" style="margin-top: 2rem;">
                        <button type="button" class="btn-secondary" onclick="app.closeAccessibilityModal()">
                            <i class="fas fa-times"></i> Fechar
                        </button>
                        <button type="button" class="btn-primary" onclick="app.resetAccessibilitySettings()">
                            <i class="fas fa-undo"></i> Restaurar Padr√µes
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <script>
            // TESTE DIRETO - Escrever no DOM para verificar se JavaScript est√° executando
            (function() {
                try {
                    // Fun√ß√£o para adicionar log (apenas no console agora)
                    function addDebugLog(msg) {
                        if (window.console && console.log) {
                            console.log(msg);
                        }
                    }
                    
                    addDebugLog('Script inline iniciado');
                    
                    function tentarInicializar() {
                        if (typeof LojaApp !== 'undefined') {
                            if (!window.app) {
                                console.log('üü° [GERENCIAMENTO.HTML] Criando LojaApp via script inline...');
                                try {
                                    window.app = new LojaApp();
                                    console.log('‚úÖ [GERENCIAMENTO.HTML] LojaApp criado com sucesso!');
                                } catch (error) {
                                    console.error('‚ùå [GERENCIAMENTO.HTML] Erro ao criar LojaApp:', error);
                                }
                            }
                        } else {
                            setTimeout(tentarInicializar, 200);
                        }
                    }
                    
                    if (document.readyState === 'complete' || document.readyState === 'interactive') {
                        setTimeout(tentarInicializar, 100);
                    } else {
                        document.addEventListener('DOMContentLoaded', function() {
                            setTimeout(tentarInicializar, 100);
                        });
                    }
                } catch (error) {
                    // Se houver erro, mostrar no DOM
                    var errorDiv = document.createElement('div');
                    errorDiv.style.cssText = 'position:fixed;top:10px;right:10px;background:red;color:white;padding:10px;z-index:9999;';
                    errorDiv.innerHTML = 'ERRO: ' + error.message;
                    document.body.appendChild(errorDiv);
                }
            })();
        </script>
        <script>
            // Carregar app.js com timestamp para evitar cache
            console.log(
                'üü£ [GERENCIAMENTO.HTML] ========== CARREGANDO APP.JS =========='
            );
            console.log('üü£ [GERENCIAMENTO.HTML] URL atual:', window.location.href);
            console.log('üü£ [GERENCIAMENTO.HTML] Timestamp:', Date.now());
            console.log(
                'üü£ [GERENCIAMENTO.HTML] SessionStorage antes de carregar app.js:',
                {
                    loggedIn: sessionStorage.getItem('loggedIn'),
                    username: sessionStorage.getItem('username'),
                }
            );

            const script = document.createElement('script');
            script.src = '/js/app.js?v=' + Date.now();

            script.onerror = function (e) {
                console.error('‚ùå [GERENCIAMENTO.HTML] Erro ao carregar app.js!');
                console.error('‚ùå [GERENCIAMENTO.HTML] Erro:', e);
                console.error('‚ùå [GERENCIAMENTO.HTML] Tentando carregar de caminho alternativo...');
                // Tentar carregar sem o / inicial (caminho relativo)
                const scriptRetry = document.createElement('script');
                scriptRetry.src = 'js/app.js?v=' + Date.now();
                scriptRetry.onerror = function() {
                    console.error('‚ùå [GERENCIAMENTO.HTML] Falha ao carregar app.js de ambos os caminhos!');
                };
                scriptRetry.onload = function() {
                    console.log('‚úÖ [GERENCIAMENTO.HTML] app.js carregado com caminho alternativo!');
                    if (typeof LojaApp !== 'undefined' && !window.app) {
                        try {
                            window.app = new LojaApp();
                            console.log('‚úÖ [GERENCIAMENTO.HTML] LojaApp criado ap√≥s retry!');
                        } catch (error) {
                            console.error('‚ùå [GERENCIAMENTO.HTML] Erro ao criar LojaApp ap√≥s retry:', error);
                        }
                    }
                };
                document.head.appendChild(scriptRetry);
            };

            script.onload = function () {
                console.log('‚úÖ [GERENCIAMENTO.HTML] app.js carregado com sucesso!');
                console.log('‚úÖ [GERENCIAMENTO.HTML] LojaApp definido?', typeof LojaApp !== 'undefined');
                
                // Garantir que a aplica√ß√£o seja inicializada mesmo se DOMContentLoaded j√° foi disparado
                let tentativas = 0;
                const maxTentativas = 10;
                function tentarInicializarApp() {
                    tentativas++;
                    if (tentativas > maxTentativas) {
                        console.error('‚ùå [GERENCIAMENTO.HTML] Limite de tentativas excedido. LojaApp n√£o p√¥de ser carregado.');
                        return;
                    }
                    
                    if (typeof LojaApp !== 'undefined') {
                        if (!window.app) {
                            console.log('üü° [GERENCIAMENTO.HTML] Criando inst√¢ncia de LojaApp...');
                            try {
                                window.app = new LojaApp();
                                console.log('‚úÖ [GERENCIAMENTO.HTML] LojaApp criado com sucesso!');
                            } catch (error) {
                                console.error('‚ùå [GERENCIAMENTO.HTML] Erro ao criar LojaApp:', error);
                                console.error('‚ùå [GERENCIAMENTO.HTML] Stack:', error.stack);
                            }
                        } else {
                            console.log('‚ÑπÔ∏è [GERENCIAMENTO.HTML] LojaApp j√° existe');
                        }
                    } else {
                        console.warn(`‚ö†Ô∏è [GERENCIAMENTO.HTML] LojaApp ainda n√£o est√° definido, tentando novamente... (${tentativas}/${maxTentativas})`);
                        setTimeout(tentarInicializarApp, 200);
                    }
                }
                
                if (document.readyState === 'complete' || document.readyState === 'interactive') {
                    console.log('üü° [GERENCIAMENTO.HTML] DOM j√° est√° pronto, inicializando app...');
                    setTimeout(tentarInicializarApp, 100);
                } else {
                    document.addEventListener('DOMContentLoaded', tentarInicializarApp);
                }
            };

            document.head.appendChild(script);
            
            // Tamb√©m garantir inicializa√ß√£o quando DOMContentLoaded disparar
            document.addEventListener('DOMContentLoaded', function() {
                console.log('üü° [GERENCIAMENTO.HTML] DOMContentLoaded disparado');
                
                let tentativasDOM = 0;
                const maxTentativasDOM = 10;
                function tentarInicializarApp() {
                    tentativasDOM++;
                    if (tentativasDOM > maxTentativasDOM) {
                        console.error('‚ùå [GERENCIAMENTO.HTML] Limite de tentativas excedido no DOMContentLoaded. LojaApp n√£o p√¥de ser carregado.');
                        return;
                    }
                    
                    if (typeof LojaApp !== 'undefined') {
                        if (!window.app) {
                            console.log('üü° [GERENCIAMENTO.HTML] Criando inst√¢ncia de LojaApp no DOMContentLoaded...');
                            try {
                                window.app = new LojaApp();
                                console.log('‚úÖ [GERENCIAMENTO.HTML] LojaApp criado com sucesso no DOMContentLoaded!');
                            } catch (error) {
                                console.error('‚ùå [GERENCIAMENTO.HTML] Erro ao criar LojaApp:', error);
                                console.error('‚ùå [GERENCIAMENTO.HTML] Stack:', error.stack);
                            }
                        } else {
                            console.log('‚ÑπÔ∏è [GERENCIAMENTO.HTML] LojaApp j√° existe no DOMContentLoaded');
                        }
                    } else {
                        console.warn(`‚ö†Ô∏è [GERENCIAMENTO.HTML] LojaApp ainda n√£o est√° definido, aguardando... (${tentativasDOM}/${maxTentativasDOM})`);
                        setTimeout(tentarInicializarApp, 200);
                    }
                }
                
                setTimeout(tentarInicializarApp, 200);
            });
        </script>
        <script>
            // Registrar Service Worker para PWA
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/sw.js')
                        .then((registration) => {
                            console.log('‚úÖ [PWA] Service Worker registrado:', registration.scope);
                            
                            // Verificar atualiza√ß√µes
                            registration.addEventListener('updatefound', () => {
                                const newWorker = registration.installing;
                                newWorker.addEventListener('statechange', () => {
                                    if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                        // Nova vers√£o dispon√≠vel
                                        console.log('üîÑ [PWA] Nova vers√£o dispon√≠vel!');
                                        if (confirm('Uma nova vers√£o est√° dispon√≠vel. Deseja atualizar?')) {
                                            newWorker.postMessage({ type: 'SKIP_WAITING' });
                                            window.location.reload();
                                        }
                                    }
                                });
                            });
                        })
                        .catch((error) => {
                            console.error('‚ùå [PWA] Erro ao registrar Service Worker:', error);
                        });
                });
            }
        </script>

        <!-- Modal: Tutorial / Como usar -->
        <div id="tutorialModal" class="modal">
            <div class="modal-content large">
                <div class="modal-header">
                    <h2>Como usar o sistema</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="if(window.app){window.app.closeTutorialModal();}else{const m=document.getElementById('tutorialModal');if(m){m.classList.remove('active');m.style.display='none';localStorage.setItem('hasSeenTutorial','true');}}">&times;</span>
                </div>
                <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                    <div id="tutorialContent">
                        <!-- Conte√∫do ser√° inserido via JavaScript -->
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="closeTutorialBtn" onclick="if(window.app){window.app.closeTutorialModal();}else{const m=document.getElementById('tutorialModal');if(m){m.classList.remove('active');m.style.display='none';localStorage.setItem('hasSeenTutorial','true');}}">Fechar</button>
                    <button type="button" class="btn-primary" id="startTutorialBtn">Iniciar Tutorial Interativo</button>
                </div>
            </div>
        </div>

        <!-- Bal√µes de Tutorial (Tooltips interativos) -->
        <div id="tutorialOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 9998; pointer-events: auto;"></div>
        <div id="tutorialTooltip" style="display: none; position: fixed; z-index: 9999; background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); max-width: 350px; pointer-events: auto;">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                <h3 style="margin: 0; color: var(--primary-color); font-size: 1.1rem;">Tutorial</h3>
                <button id="closeTutorialTooltip" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--gray-600);">&times;</button>
            </div>
            <div id="tutorialTooltipContent" style="margin-bottom: 1rem; color: var(--gray-700); line-height: 1.6;"></div>
            <div style="display: flex; justify-content: space-between; gap: 0.5rem;">
                <button id="tutorialPrevBtn" class="btn-secondary" style="flex: 1;">Anterior</button>
                <button id="tutorialNextBtn" class="btn-primary" style="flex: 1;">Pr√≥ximo</button>
            </div>
            <div style="margin-top: 0.5rem; text-align: center;">
                <button id="tutorialSkipBtn" class="btn-secondary" style="font-size: 0.85rem; padding: 0.4rem 0.8rem;">Pular Tutorial</button>
            </div>
        </div>

        <!-- Modal: Gerenciamento de Backups -->
        <div id="backupModal" class="modal">
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <h2><i class="fas fa-database"></i> Gerenciamento de Backups</h2>
                    <span class="close" aria-label="Fechar modal" role="button" tabindex="0" onclick="app.closeBackupModal()">&times;</span>
                </div>
                <div style="padding: 1.5rem;">
                    <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap;">
                        <button class="btn-primary" onclick="app.createManualBackup()">
                            <i class="fas fa-save"></i> Criar Backup Agora
                        </button>
                        <button class="btn-secondary" onclick="app.configureAutoBackup()">
                            <i class="fas fa-cog"></i> Configurar Backup Autom√°tico
                        </button>
                    </div>
                    
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="checkbox" id="autoBackupEnabled" onchange="app.toggleAutoBackup()" />
                            <span>Backup autom√°tico ativado</span>
                        </label>
                        <select id="autoBackupFrequency" style="margin-top: 0.5rem; width: 100%;" onchange="app.updateAutoBackupFrequency()">
                            <option value="daily">Di√°rio (1x por dia)</option>
                            <option value="weekly">Semanal (1x por semana)</option>
                        </select>
                    </div>

                    <h3 style="margin: 1.5rem 0 1rem 0; font-size: 1.1rem; color: var(--primary-color);">
                        <i class="fas fa-history"></i> Hist√≥rico de Backups
                    </h3>
                    <div id="backupHistoryList" style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 1rem;">
                        <!-- Hist√≥rico ser√° inserido aqui via JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>


