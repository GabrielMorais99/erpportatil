<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Sistema de gestão de loja de roupas - Controle de vendas e custos">
    <meta name="theme-color" content="#dc3545">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Loja Vendas">
    <title>Loja - Login</title>
    <link rel="stylesheet" href="/css/style.css" id="css-link">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
    <link rel="apple-touch-icon" href="/icon-192.png">
    <script>
        // Forçar recarregamento do CSS adicionando timestamp
        (function() {
            const cssLink = document.getElementById('css-link');
            if (cssLink) {
                cssLink.href = '/css/style.css?v=' + Date.now();
            }
        })();
    </script>
</head>
<body>
    <div class="login-container">
        <div class="login-box">
            <div class="logo">
                <h1>Loja</h1>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Usuário</label>
                    <input type="text" id="username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <div id="errorMessage" class="error-message"></div>
                <button type="submit" class="btn-primary">Entrar</button>
            </form>
            <div class="signature">
                <p>Gerenciamento de loja vendas</p>
            </div>
        </div>
    </div>
    <script>
        // Carregar login.js com timestamp para evitar cache
        const script = document.createElement('script');
        script.src = '/js/login.js?v=' + Date.now();
        script.onerror = function() {
            this.src = '/js/login.js?v=' + Date.now();
        };
        document.head.appendChild(script);
    </script>
    <script>
        // Service Worker DESABILITADO temporariamente para evitar cache
        // TODO: Reabilitar quando cache estiver funcionando corretamente
        /*
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('Service Worker registrado:', registration);
                    })
                    .catch((error) => {
                        console.log('Erro ao registrar Service Worker:', error);
                    });
            });
        }
        */
        
        // Desregistrar qualquer Service Worker existente
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function(registrations) {
                for(let registration of registrations) {
                    registration.unregister();
                    console.log('Service Worker desregistrado');
                }
            });
        }
    </script>
</body>
</html>

